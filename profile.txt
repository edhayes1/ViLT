
Profiler Report

Profile stats for: on_fit_start
         52 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:49(on_fit_start)
        4    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        4    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        1    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
        4    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        4    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        4    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 profilers.py:59(profile)
        1    0.000    0.000    0.000    0.000 profilers.py:251(stop)
        4    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
        4    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.000    0.000 base.py:46(on_fit_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_start
         47 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:169(on_validation_start)
        4    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        4    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        4    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        4    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        1    0.000    0.000    0.000    0.000 profilers.py:59(profile)
        4    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        1    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        5    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        1    0.000    0.000    0.000    0.000 profilers.py:251(stop)
        1    0.000    0.000    0.000    0.000 progress.py:340(on_validation_start)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 progress.py:157(on_validation_start)
        2    0.000    0.000    0.000    0.000 base.py:142(on_validation_start)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: cache_result
         20612 function calls in 0.033 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      104    0.001    0.000    0.009    0.000 deprecated_api.py:71(use_dp)
      104    0.001    0.000    0.008    0.000 __init__.py:62(__eq__)
      104    0.001    0.000    0.007    0.000 epoch_result_store.py:297(reset_model)
      210    0.001    0.000    0.007    0.000 types.py:171(__get__)
      726    0.001    0.000    0.007    0.000 properties.py:259(get_model)
      210    0.006    0.000    0.006    0.000 enum.py:753(value)
      726    0.001    0.000    0.006    0.000 model_connector.py:48(get_model)
     1140    0.004    0.000    0.005    0.000 module.py:1180(__setattr__)
      726    0.001    0.000    0.005    0.000 model_connector.py:51(_get_reference_model)
      104    0.001    0.000    0.004    0.000 step_result.py:30(__init__)
      726    0.001    0.000    0.004    0.000 ddp_accelerator.py:359(get_reference_model)
      104    0.001    0.000    0.003    0.000 os.py:678(__setitem__)
      726    0.002    0.000    0.003    0.000 ddp_plugin.py:123(get_model_from_plugin)
      518    0.000    0.000    0.002    0.000 contextlib.py:117(__exit__)
      104    0.001    0.000    0.002    0.000 step_result.py:405(detach)
      518    0.000    0.000    0.002    0.000 {built-in method builtins.next}
      104    0.001    0.000    0.001    0.000 epoch_result_store.py:157(append)
      518    0.000    0.000    0.001    0.000 profilers.py:59(profile)
      104    0.001    0.000    0.001    0.000 {built-in method posix.putenv}
     3879    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
      316    0.001    0.000    0.001    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
      726    0.001    0.000    0.001    0.000 module.py:1164(__getattr__)
      518    0.001    0.000    0.001    0.000 profilers.py:251(stop)
      104    0.000    0.000    0.001    0.000 epoch_result_store.py:306(current_model_info)
      208    0.000    0.000    0.001    0.000 os.py:748(encode)
     3938    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
      104    0.000    0.000    0.001    0.000 step_result.py:259(attach_batch_size)
      100    0.000    0.000    0.000    0.000 epoch_result_store.py:151(_append_to_structure)
        2    0.000    0.000    0.000    0.000 epoch_result_store.py:358(update_logger_connector)
      104    0.000    0.000    0.000    0.000 epoch_result_store.py:73(__init__)
        6    0.000    0.000    0.000    0.000 epoch_result_store.py:453(run_epoch_by_func_name)
      308    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
      140    0.000    0.000    0.000    0.000 step_result.py:59(__getitem__)
        6    0.000    0.000    0.000    0.000 epoch_result_store.py:457(<listcomp>)
      658    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       12    0.000    0.000    0.000    0.000 epoch_result_store.py:131(get_epoch_from_func_name)
      100    0.000    0.000    0.000    0.000 epoch_result_store.py:290(extra_info)
      208    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        2    0.000    0.000    0.000    0.000 epoch_result_store.py:460(get_epoch_pbar_metrics)
       12    0.000    0.000    0.000    0.000 epoch_result_store.py:124(run_epoch_func)
      104    0.000    0.000    0.000    0.000 epoch_result_store.py:283(has_split_and_opt_idx)
        2    0.000    0.000    0.000    0.000 epoch_result_store.py:463(get_epoch_log_metrics)
      518    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        4    0.000    0.000    0.000    0.000 epoch_result_store.py:145(get_epoch_log_metrics)
      208    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        4    0.000    0.000    0.000    0.000 epoch_result_store.py:142(get_epoch_pbar_metrics)
      218    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        4    0.000    0.000    0.000    0.000 step_result.py:304(get_epoch_log_metrics)
        2    0.000    0.000    0.000    0.000 epoch_result_store.py:466(get_forked_metrics)
        8    0.000    0.000    0.000    0.000 epoch_result_store.py:427(has_reduced)
        4    0.000    0.000    0.000    0.000 epoch_result_store.py:148(get_forked_metrics)
      140    0.000    0.000    0.000    0.000 {function Result.__getitem__ at 0x7efa9d04b940}
        4    0.000    0.000    0.000    0.000 step_result.py:332(get_epoch_pbar_metrics)
        2    0.000    0.000    0.000    0.000 epoch_result_store.py:432(auto_reduce_results_on_epoch_end)
      130    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
       14    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
       13    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
        4    0.000    0.000    0.000    0.000 step_result.py:360(get_forked_metrics)
        6    0.000    0.000    0.000    0.000 epoch_result_store.py:456(<listcomp>)
        4    0.000    0.000    0.000    0.000 epoch_result_store.py:194(auto_reduce_results_on_epoch_end)
       26    0.000    0.000    0.000    0.000 epoch_result_store.py:85(num_dataloaders)
       13    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       12    0.000    0.000    0.000    0.000 epoch_result_store.py:81(has_several_dataloaders)
       12    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        6    0.000    0.000    0.000    0.000 epoch_result_store.py:458(<dictcomp>)
        2    0.000    0.000    0.000    0.000 logger_connector.py:202(add_progress_bar_metrics)
       48    0.000    0.000    0.000    0.000 step_result.py:274(_add_dataloader_idx)
       24    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       24    0.000    0.000    0.000    0.000 epoch_result_store.py:430(<genexpr>)
       19    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 debugging.py:29(wrapped_fn)
        4    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}



Profile stats for: on_validation_epoch_start
         48 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:79(on_validation_epoch_start)
        4    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        4    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        4    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        4    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        1    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
        4    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 profilers.py:59(profile)
        1    0.000    0.000    0.000    0.000 profilers.py:251(stop)
        4    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        3    0.000    0.000    0.000    0.000 base.py:78(on_validation_epoch_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_batch_start
         96 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 callback_hook.py:149(on_validation_batch_start)
        2    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
        8    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        8    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        8    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        8    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        8    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        2    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 profilers.py:59(profile)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        8    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        2    0.000    0.000    0.000    0.000 profilers.py:251(stop)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        6    0.000    0.000    0.000    0.000 base.py:106(on_validation_batch_start)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: evaluation_step_and_end
         20693 function calls (17499 primitive calls) in 1.608 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    1.608    0.804 evaluation_loop.py:166(evaluation_step)
        2    0.000    0.000    1.606    0.803 ddp_accelerator.py:160(validation_step)
        2    0.000    0.000    1.606    0.803 ddp_accelerator.py:166(_step)
    884/2    0.005    0.000    1.599    0.800 module.py:1096(_call_impl)
        2    0.000    0.000    1.599    0.800 data_parallel.py:163(forward)
        2    0.000    0.000    1.588    0.794 mmcl.py:167(validation_step)
        2    0.000    0.000    1.588    0.794 mmcl.py:130(forward)
        4    0.002    0.000    1.406    0.352 mmcl.py:87(infer)
        4    0.162    0.040    0.942    0.236 vision_transformer.py:557(visual_embed)
       64    0.487    0.008    0.487    0.008 {built-in method multinomial}
       48    0.063    0.001    0.372    0.008 vision_transformer.py:370(forward)
       48    0.139    0.003    0.183    0.004 vision_transformer.py:309(forward)
        4    0.000    0.000    0.175    0.044 objectives.py:91(compute_mlm)
        8    0.001    0.000    0.164    0.021 metric.py:147(forward)
       16    0.001    0.000    0.154    0.010 metric.py:242(reset)
       86    0.151    0.002    0.151    0.002 {method 'to' of 'torch._C._TensorBase' objects}
        4    0.001    0.000    0.121    0.030 vision_transformer.py:573(<listcomp>)
       68    0.001    0.000    0.091    0.001 functional.py:3542(interpolate)
       64    0.089    0.001    0.089    0.001 {built-in method torch._C._nn.upsample_bilinear2d}
      212    0.001    0.000    0.089    0.000 linear.py:102(forward)
      212    0.000    0.000    0.088    0.000 functional.py:1832(linear)
       48    0.017    0.000    0.088    0.002 vision_transformer.py:279(forward)
      212    0.088    0.000    0.088    0.000 {built-in method torch._C._nn.linear}
        4    0.001    0.000    0.086    0.022 modeling_bert.py:183(forward)
       20    0.000    0.000    0.084    0.004 sparse.py:157(forward)
       16    0.000    0.000    0.084    0.005 _tensor.py:632(__iter__)
       20    0.000    0.000    0.083    0.004 functional.py:1950(embedding)
       20    0.083    0.004    0.083    0.004 {built-in method embedding}
       16    0.083    0.005    0.083    0.005 {method 'unbind' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.066    0.016 vision_transformer.py:404(forward)
        4    0.000    0.000    0.066    0.016 conv.py:445(forward)
        4    0.000    0.000    0.066    0.016 conv.py:437(_conv_forward)
        4    0.066    0.016    0.066    0.016 {built-in method conv2d}
      108    0.001    0.000    0.037    0.000 normalization.py:188(forward)
      108    0.001    0.000    0.036    0.000 functional.py:2332(layer_norm)
      108    0.035    0.000    0.035    0.000 {built-in method layer_norm}
       64    0.001    0.000    0.026    0.000 functional.py:4111(_pad)
       64    0.025    0.000    0.025    0.000 {built-in method constant_pad_nd}
       48    0.016    0.000    0.016    0.000 {method 'softmax' of 'torch._C._TensorBase' objects}
       16    0.000    0.000    0.008    0.001 metric.py:197(wrapped_func)
        2    0.000    0.000    0.008    0.004 distributed.py:1361(_sync_params)
        4    0.002    0.001    0.007    0.002 heads.py:58(forward)
        8    0.005    0.001    0.007    0.001 my_metrics.py:11(update)
        2    0.001    0.000    0.006    0.003 objectives.py:110(compute_cl)
        4    0.006    0.002    0.006    0.002 vision_transformer.py:620(<listcomp>)
       32    0.000    0.000    0.006    0.000 copy.py:128(deepcopy)
        4    0.006    0.001    0.006    0.001 vision_transformer.py:621(<listcomp>)
        2    0.000    0.000    0.005    0.003 ddp_plugin.py:101(on_before_forward)
        2    0.000    0.000    0.005    0.003 hooks.py:505(transfer_batch_to_device)
        2    0.000    0.000    0.005    0.003 apply_func.py:94(move_data_to_device)
       32    0.001    0.000    0.005    0.000 _tensor.py:81(__deepcopy__)
    102/2    0.000    0.000    0.005    0.003 apply_func.py:30(apply_to_collection)
     10/2    0.000    0.000    0.005    0.003 apply_func.py:60(<listcomp>)
        2    0.000    0.000    0.005    0.002 apply_func.py:53(<dictcomp>)
        8    0.000    0.000    0.005    0.001 metric.py:204(wrapped_func)
       24    0.000    0.000    0.004    0.000 apply_func.py:112(batch_to)
      200    0.001    0.000    0.004    0.000 dropout.py:57(forward)
       90    0.004    0.000    0.004    0.000 {built-in method cat}
        2    0.000    0.000    0.004    0.002 distributed.py:741(_assign_modules_buffers)
        2    0.000    0.000    0.004    0.002 distributed.py:1331(_distributed_broadcast_coalesced)
        2    0.004    0.002    0.004    0.002 {built-in method torch._C._distributed_c10d._broadcast_coalesced}
        2    0.000    0.000    0.004    0.002 distributed.py:750(<listcomp>)
       10    0.000    0.000    0.004    0.000 module.py:1571(named_buffers)
       10    0.000    0.000    0.004    0.000 module.py:1486(_named_members)
      132    0.000    0.000    0.004    0.000 _tensor.py:25(wrapped)
       48    0.003    0.000    0.003    0.000 {method 'masked_fill' of 'torch._C._TensorBase' objects}
      200    0.001    0.000    0.003    0.000 functional.py:1152(dropout)
      132    0.000    0.000    0.003    0.000 _tensor.py:544(__rsub__)
        2    0.000    0.000    0.003    0.002 distributed.py:945(scatter)
        2    0.000    0.000    0.003    0.002 scatter_gather.py:42(scatter_kwargs)
        2    0.000    0.000    0.003    0.002 scatter_gather.py:11(scatter)
      132    0.003    0.000    0.003    0.000 {built-in method rsub}
    158/2    0.001    0.000    0.003    0.001 scatter_gather.py:17(scatter_map)
        4    0.000    0.000    0.003    0.001 heads.py:44(forward)
     1568    0.003    0.000    0.003    0.000 module.py:1164(__getattr__)
 2454/410    0.002    0.000    0.003    0.000 module.py:1653(named_modules)
        4    0.000    0.000    0.003    0.001 container.py:139(forward)
        2    0.000    0.000    0.002    0.001 logger_connector.py:74(cache_logged_metrics)
        2    0.000    0.000    0.002    0.001 epoch_result_store.py:317(cache_result)
        2    0.000    0.000    0.002    0.001 contextlib.py:108(__enter__)
        2    0.000    0.000    0.002    0.001 {built-in method builtins.next}
        2    0.000    0.000    0.002    0.001 profilers.py:59(profile)
        4    0.000    0.000    0.002    0.000 functional.py:2767(cross_entropy)
        2    0.000    0.000    0.002    0.001 profilers.py:246(start)
        4    0.000    0.000    0.002    0.000 _tensor.py:520(unique)
       24    0.000    0.000    0.002    0.000 {built-in method apply}
        4    0.002    0.000    0.002    0.000 {built-in method torch._C._nn.cross_entropy_loss}
        4    0.000    0.000    0.002    0.000 modeling_bert.py:626(forward)
        2    0.002    0.001    0.002    0.001 {method 'enable' of '_lsprof.Profiler' objects}
       96    0.002    0.000    0.002    0.000 {method 'reshape' of 'torch._C._TensorBase' objects}
      200    0.002    0.000    0.002    0.000 {built-in method dropout}
      8/4    0.000    0.000    0.002    0.000 _jit_internal.py:412(fn)
        4    0.000    0.000    0.002    0.000 heads.py:27(forward)
        4    0.000    0.000    0.002    0.000 functional.py:815(_return_output)
        4    0.000    0.000    0.002    0.000 functional.py:660(_unique_impl)
      164    0.001    0.000    0.002    0.000 module.py:1180(__setattr__)
        4    0.002    0.000    0.002    0.000 {built-in method _unique2}
       32    0.000    0.000    0.001    0.000 storage.py:44(__deepcopy__)
       52    0.000    0.000    0.001    0.000 functional.py:1544(gelu)
        8    0.001    0.000    0.001    0.000 my_metrics.py:37(update)
       24    0.000    0.000    0.001    0.000 _functions.py:87(forward)
       48    0.000    0.000    0.001    0.000 activation.py:651(forward)
      900    0.001    0.000    0.001    0.000 {built-in method torch._C._get_tracing_state}
     1886    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
       48    0.001    0.000    0.001    0.000 {method 'bool' of 'torch._C._TensorBase' objects}
       52    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.gelu}
       32    0.001    0.000    0.001    0.000 storage.py:60(clone)
       10    0.000    0.000    0.001    0.000 lightning.py:192(log)
        4    0.000    0.000    0.001    0.000 functional.py:4425(normalize)
        4    0.000    0.000    0.001    0.000 functional.py:337(meshgrid)
       68    0.001    0.000    0.001    0.000 {built-in method ones}
        4    0.000    0.000    0.001    0.000 functional.py:433(_meshgrid)
      108    0.001    0.000    0.001    0.000 {method 'transpose' of 'torch._C._TensorBase' objects}
       32    0.001    0.000    0.001    0.000 {method 'new_empty' of 'torch._C._TensorBase' objects}
        4    0.001    0.000    0.001    0.000 {built-in method meshgrid}
        8    0.001    0.000    0.001    0.000 {method 'nonzero' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.001    0.000 batchnorm.py:134(forward)
       10    0.001    0.000    0.001    0.000 {built-in method sum}
       24    0.000    0.000    0.001    0.000 comm.py:152(scatter)
       14    0.001    0.000    0.001    0.000 {method 'sum' of 'torch._C._TensorBase' objects}
       48    0.000    0.000    0.001    0.000 {built-in method builtins.setattr}
        4    0.000    0.000    0.001    0.000 functional.py:2251(batch_norm)
        8    0.001    0.000    0.001    0.000 {method 'argmax' of 'torch._C._TensorBase' objects}
       32    0.001    0.000    0.001    0.000 {method 'set_' of 'torch._C._TensorBase' objects}
        4    0.001    0.000    0.001    0.000 {built-in method batch_norm}
       48    0.001    0.000    0.001    0.000 {method 'permute' of 'torch._C._TensorBase' objects}
        4    0.001    0.000    0.001    0.000 {built-in method builtins.min}
      256    0.000    0.000    0.001    0.000 abc.py:96(__instancecheck__)
      272    0.000    0.000    0.001    0.000 _VF.py:25(__getattr__)
      408    0.000    0.000    0.001    0.000 module.py:1592(<lambda>)
       10    0.000    0.000    0.001    0.000 step_result.py:114(log)
       34    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 _tensor.py:438(norm)
      256    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       32    0.000    0.000    0.000    0.000 __init__.py:265(__init__)
      368    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        4    0.000    0.000    0.000    0.000 functional.py:1315(norm)
        4    0.000    0.000    0.000    0.000 {built-in method zeros}
        4    0.000    0.000    0.000    0.000 my_metrics.py:45(compute)
       24    0.000    0.000    0.000    0.000 {built-in method torch._C._scatter}
       28    0.000    0.000    0.000    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       42    0.000    0.000    0.000    0.000 grad_mode.py:124(__enter__)
        4    0.000    0.000    0.000    0.000 {built-in method norm}
       42    0.000    0.000    0.000    0.000 grad_mode.py:128(__exit__)
       32    0.000    0.000    0.000    0.000 _utils.py:7(_get_device_index)
       84    0.000    0.000    0.000    0.000 grad_mode.py:213(__init__)
       42    0.000    0.000    0.000    0.000 grad_mode.py:119(__init__)
        4    0.000    0.000    0.000    0.000 activation.py:97(forward)
       68    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method mm}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._nn.upsample_nearest2d}
        4    0.000    0.000    0.000    0.000 {method 'max' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 functional.py:1288(relu)
        4    0.000    0.000    0.000    0.000 activation.py:348(forward)
       10    0.000    0.000    0.000    0.000 step_result.py:212(__set_meta)
        4    0.000    0.000    0.000    0.000 {built-in method relu}
      112    0.000    0.000    0.000    0.000 __init__.py:31(__get__)
        4    0.000    0.000    0.000    0.000 {built-in method tanh}
        4    0.000    0.000    0.000    0.000 {built-in method exp}
        4    0.000    0.000    0.000    0.000 {built-in method zeros_like}
        1    0.000    0.000    0.000    0.000 warnings.py:96(_showwarnmsg)
        1    0.000    0.000    0.000    0.000 warnings.py:20(_showwarnmsg_impl)
        2    0.000    0.000    0.000    0.000 autocast_mode.py:179(__exit__)
        4    0.000    0.000    0.000    0.000 {built-in method stack}
        2    0.000    0.000    0.000    0.000 autocast_mode.py:16(__init__)
       80    0.000    0.000    0.000    0.000 _utils.py:476(_get_device_index)
       72    0.000    0.000    0.000    0.000 abc.py:100(__subclasscheck__)
      676    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
       32    0.000    0.000    0.000    0.000 copy.py:242(_keep_alive)
       16    0.000    0.000    0.000    0.000 {method 'flatten' of 'torch._C._TensorBase' objects}
      556    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      484    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      488    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        8    0.000    0.000    0.000    0.000 {built-in method arange}
       12    0.000    0.000    0.000    0.000 device_dtype_mixin.py:38(device)
        4    0.000    0.000    0.000    0.000 my_metrics.py:27(compute)
        2    0.000    0.000    0.000    0.000 vilt_utils.py:163(set_task)
       72    0.000    0.000    0.000    0.000 {built-in method _abc._abc_subclasscheck}
      164    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {method 'clamp_min' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 autocast_mode.py:131(__init__)
        2    0.000    0.000    0.000    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.000    0.000 {method 'expand' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch._C.clear_autocast_cache}
        2    0.000    0.000    0.000    0.000 step_result.py:30(__init__)
        1    0.000    0.000    0.000    0.000 warnings.py:117(_formatwarnmsg)
        2    0.000    0.000    0.000    0.000 {built-in method log}
       32    0.000    0.000    0.000    0.000 {method 'copy_' of 'torch._C.FloatStorageBase' objects}
        1    0.000    0.000    0.000    0.000 warnings.py:35(_formatwarnmsg_impl)
       24    0.000    0.000    0.000    0.000 _utils.py:518(_handle_complex)
        4    0.000    0.000    0.000    0.000 {built-in method full_like}
      416    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
      134    0.000    0.000    0.000    0.000 scatter_gather.py:4(is_namedtuple)
        4    0.000    0.000    0.000    0.000 {method 'long' of 'torch._C._TensorBase' objects}
      816    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        2    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
       26    0.000    0.000    0.000    0.000 __init__.py:74(is_available)
        2    0.000    0.000    0.000    0.000 {built-in method clamp}
      128    0.000    0.000    0.000    0.000 {built-in method torch._C.is_grad_enabled}
       24    0.000    0.000    0.000    0.000 _functions.py:89(<listcomp>)
        2    0.000    0.000    0.000    0.000 os.py:678(__setitem__)
        2    0.000    0.000    0.000    0.000 {method 'contiguous' of 'torch._C._TensorBase' objects}
       32    0.000    0.000    0.000    0.000 {method 'storage' of 'torch._C._TensorBase' objects}
      112    0.000    0.000    0.000    0.000 {built-in method torch._C._get_cudnn_enabled}
      176    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        4    0.000    0.000    0.000    0.000 vision_transformer.py:625(<listcomp>)
        2    0.000    0.000    0.000    0.000 autocast_mode.py:163(__enter__)
       24    0.000    0.000    0.000    0.000 comm.py:188(<listcomp>)
        2    0.000    0.000    0.000    0.000 data_parallel.py:220(reducer_reset_hooks)
        2    0.000    0.000    0.000    0.000 data_parallel.py:207(reducer_prepare_for_backwards)
        2    0.000    0.000    0.000    0.000 __init__.py:62(__eq__)
       32    0.000    0.000    0.000    0.000 _tensor.py:1001(grad)
       78    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        2    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
       20    0.000    0.000    0.000    0.000 step_result.py:59(__getitem__)
        1    0.000    0.000    0.000    0.000 linecache.py:15(getline)
      264    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       94    0.000    0.000    0.000    0.000 scatter_gather.py:28(<listcomp>)
        4    0.000    0.000    0.000    0.000 vision_transformer.py:626(<listcomp>)
       16    0.000    0.000    0.000    0.000 _tensor.py:650(__hash__)
        4    0.000    0.000    0.000    0.000 {method 'expand_as' of 'torch._C._TensorBase' objects}
       32    0.000    0.000    0.000    0.000 {method 'is_neg' of 'torch._C._TensorBase' objects}
      136    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
       10    0.000    0.000    0.000    0.000 __init__.py:8(is_available)
       32    0.000    0.000    0.000    0.000 {method 'is_conj' of 'torch._C._TensorBase' objects}
       84    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
        6    0.000    0.000    0.000    0.000 apply_func.py:86(__subclasshook__)
        4    0.000    0.000    0.000    0.000 container.py:210(__iter__)
        2    0.000    0.000    0.000    0.000 common.py:5(amp_definitely_not_available)
       10    0.000    0.000    0.000    0.000 lightning.py:1680(hparams)
       96    0.000    0.000    0.000    0.000 linear.py:35(forward)
       64    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
       10    0.000    0.000    0.000    0.000 distributed_c10d.py:386(is_initialized)
       10    0.000    0.000    0.000    0.000 parsing.py:182(__getattr__)
        2    0.000    0.000    0.000    0.000 evaluation_loop.py:146(build_args)
       26    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_getDeviceCount}
        2    0.000    0.000    0.000    0.000 {built-in method posix.putenv}
        4    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        4    0.000    0.000    0.000    0.000 types.py:171(__get__)
        8    0.000    0.000    0.000    0.000 metric.py:161(<dictcomp>)
       24    0.000    0.000    0.000    0.000 {method 'is_complex' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {method 'fill_' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        1    0.000    0.000    0.000    0.000 warnings.py:403(__init__)
       32    0.000    0.000    0.000    0.000 {method 'stride' of 'torch._C._TensorBase' objects}
       32    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.FloatStorageBase' objects}
       10    0.000    0.000    0.000    0.000 lightning.py:354(__auto_choose_log_on_step)
        4    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        4    0.000    0.000    0.000    0.000 os.py:748(encode)
       74    0.000    0.000    0.000    0.000 _jit_internal.py:957(is_scripting)
        4    0.000    0.000    0.000    0.000 container.py:131(__iter__)
       32    0.000    0.000    0.000    0.000 __init__.py:278(__exit__)
       32    0.000    0.000    0.000    0.000 __init__.py:269(__enter__)
       32    0.000    0.000    0.000    0.000 {method 'storage_offset' of 'torch._C._TensorBase' objects}
       66    0.000    0.000    0.000    0.000 _collections_abc.py:302(__subclasshook__)
       24    0.000    0.000    0.000    0.000 {built-in method builtins.iter}
        2    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
        4    0.000    0.000    0.000    0.000 enum.py:753(value)
        2    0.000    0.000    0.000    0.000 evaluation_loop.py:158(_get_num_dataloaders)
       32    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C.get_autocast_gpu_dtype}
        2    0.000    0.000    0.000    0.000 scatter_gather.py:27(<listcomp>)
       32    0.000    0.000    0.000    0.000 storage.py:13(__init__)
        1    0.000    0.000    0.000    0.000 linecache.py:37(getlines)
        4    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        2    0.000    0.000    0.000    0.000 {method 't' of 'torch._C._TensorBase' objects}
       16    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        8    0.000    0.000    0.000    0.000 scatter_gather.py:25(<listcomp>)
       24    0.000    0.000    0.000    0.000 {method 'get_device' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 distributed.py:1338(will_sync_module_buffers)
        4    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        4    0.000    0.000    0.000    0.000 vision_transformer.py:627(<listcomp>)
        4    0.000    0.000    0.000    0.000 batchnorm.py:297(_check_input_dim)
        2    0.000    0.000    0.000    0.000 vilt_utils.py:164(<listcomp>)
       32    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 lightning.py:366(__auto_choose_log_on_epoch)
       32    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
        2    0.000    0.000    0.000    0.000 distributed.py:754(<listcomp>)
        4    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        4    0.000    0.000    0.000    0.000 _reduction.py:7(get_enum)
       20    0.000    0.000    0.000    0.000 {function Result.__getitem__ at 0x7efa9d04b940}
        8    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C.set_autocast_enabled}
        2    0.000    0.000    0.000    0.000 {built-in method torch._C.is_autocast_enabled}
        8    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
        2    0.000    0.000    0.000    0.000 ddp_plugin.py:95(is_running_single_process_per_device)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C.set_autocast_cache_enabled}
        2    0.000    0.000    0.000    0.000 {built-in method torch._C.autocast_increment_nesting}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C.set_autocast_gpu_dtype}
        2    0.000    0.000    0.000    0.000 {built-in method torch._C.autocast_decrement_nesting}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C.is_autocast_cache_enabled}
        4    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        4    0.000    0.000    0.000    0.000 scatter_gather.py:49(<genexpr>)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
        2    0.000    0.000    0.000    0.000 data_parallel.py:224(warn_missing_output)



Profile stats for: validation_step_end
         48 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        2    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        2    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        2    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        2    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        2    0.000    0.000    0.000    0.000 profilers.py:59(profile)
        2    0.000    0.000    0.000    0.000 profilers.py:251(stop)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        2    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 accelerator.py:84(validation_step_end)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_batch_end
         1734 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.002    0.001 callback_hook.py:154(on_validation_batch_end)
        2    0.000    0.000    0.002    0.001 progress.py:347(on_validation_batch_end)
        4    0.000    0.000    0.002    0.000 progress.py:379(_update_bar)
        4    0.000    0.000    0.002    0.000 std.py:1182(update)
        2    0.000    0.000    0.002    0.001 std.py:1304(refresh)
        2    0.000    0.000    0.002    0.001 std.py:1436(display)
        2    0.000    0.000    0.001    0.001 std.py:1136(__repr__)
        2    0.000    0.000    0.001    0.000 std.py:353(format_meter)
        6    0.000    0.000    0.001    0.000 utils.py:324(disp_len)
        6    0.000    0.000    0.000    0.000 utils.py:320(_text_width)
        8    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
      690    0.000    0.000    0.000    0.000 utils.py:321(<genexpr>)
        2    0.000    0.000    0.000    0.000 std.py:1420(format_dict)
        2    0.000    0.000    0.000    0.000 std.py:346(print_status)
        2    0.000    0.000    0.000    0.000 utils.py:273(_screen_shape_linux)
        2    0.000    0.000    0.000    0.000 utils.py:332(disp_trim)
        2    0.000    0.000    0.000    0.000 progress.py:106(total_val_batches)
      684    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
       16    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        2    0.000    0.000    0.000    0.000 std.py:340(fp_write)
        4    0.000    0.000    0.000    0.000 utils.py:141(inner)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        4    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
       10    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        8    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        2    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
       10    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        2    0.000    0.000    0.000    0.000 properties.py:190(disable_validation)
       10    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        2    0.000    0.000    0.000    0.000 std.py:155(__init__)
        2    0.000    0.000    0.000    0.000 std.py:104(acquire)
        2    0.000    0.000    0.000    0.000 properties.py:195(enable_validation)
        2    0.000    0.000    0.000    0.000 progress.py:376(_should_update)
       10    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        4    0.000    0.000    0.000    0.000 std.py:289(format_interval)
       12    0.000    0.000    0.000    0.000 std.py:234(__call__)
        4    0.000    0.000    0.000    0.000 utils.py:214(_is_ascii)
        2    0.000    0.000    0.000    0.000 std.py:108(release)
        2    0.000    0.000    0.000    0.000 std.py:188(__format__)
        2    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        2    0.000    0.000    0.000    0.000 progress.py:160(on_validation_batch_end)
        2    0.000    0.000    0.000    0.000 {built-in method now}
        2    0.000    0.000    0.000    0.000 progress.py:242(is_enabled)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       10    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        2    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        2    0.000    0.000    0.000    0.000 profilers.py:59(profile)
        6    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 profilers.py:251(stop)
       42    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
       18    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        2    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 std.py:169(colour)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        8    0.000    0.000    0.000    0.000 progress.py:234(refresh_rate)
        8    0.000    0.000    0.000    0.000 progress.py:69(trainer)
        2    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.min}
        6    0.000    0.000    0.000    0.000 {built-in method time.time}
        2    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        2    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 std.py:165(colour)
        4    0.000    0.000    0.000    0.000 base.py:110(on_validation_batch_end)
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        2    0.000    0.000    0.000    0.000 progress.py:81(val_batch_idx)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_epoch_end
         48 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:84(on_validation_epoch_end)
        1    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
        4    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        4    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        4    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        4    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        4    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profilers.py:59(profile)
        1    0.000    0.000    0.000    0.000 profilers.py:251(stop)
        4    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        3    0.000    0.000    0.000    0.000 base.py:82(on_validation_epoch_end)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_end
         185 function calls (163 primitive calls) in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 callback_hook.py:174(on_validation_end)
        1    0.000    0.000    0.000    0.000 progress.py:353(on_validation_end)
        1    0.000    0.000    0.000    0.000 std.py:1248(close)
        1    0.000    0.000    0.000    0.000 std.py:1376(set_postfix)
       11    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        2    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        1    0.000    0.000    0.000    0.000 std.py:583(_decr_instances)
     13/2    0.000    0.000    0.000    0.000 abc.py:100(__subclasscheck__)
     13/2    0.000    0.000    0.000    0.000 {built-in method _abc._abc_subclasscheck}
        1    0.000    0.000    0.000    0.000 properties.py:183(progress_bar_dict)
        1    0.000    0.000    0.000    0.000 std.py:1436(display)
        1    0.000    0.000    0.000    0.000 std.py:346(print_status)
        4    0.000    0.000    0.000    0.000 utils.py:141(inner)
        1    0.000    0.000    0.000    0.000 lightning.py:1382(get_progress_bar_dict)
        3    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 std.py:340(fp_write)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:106(remove)
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:58(__iter__)
        2    0.000    0.000    0.000    0.000 std.py:1265(fp_write)
        2    0.000    0.000    0.000    0.000 std.py:104(acquire)
        2    0.000    0.000    0.000    0.000 {method 'remove' of 'set' objects}
        4    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        4    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:199(on_validation_end)
        1    0.000    0.000    0.000    0.000 properties.py:175(data_parallel)
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
        4    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        1    0.000    0.000    0.000    0.000 utils.py:324(disp_len)
        2    0.000    0.000    0.000    0.000 std.py:108(release)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 std.py:311(format_num)
        4    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        1    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
        4    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        2    0.000    0.000    0.000    0.000 __init__.py:62(__eq__)
        1    0.000    0.000    0.000    0.000 std.py:1143(__hash__)
        6    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        1    0.000    0.000    0.000    0.000 deprecated_api.py:71(use_dp)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:218(save_checkpoint)
        2    0.000    0.000    0.000    0.000 tensorboard.py:232(version)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 _weakrefset.py:20(__enter__)
        1    0.000    0.000    0.000    0.000 profilers.py:59(profile)
        1    0.000    0.000    0.000    0.000 utils.py:74(__eq__)
        1    0.000    0.000    0.000    0.000 deprecated_api.py:82(use_ddp)
        1    0.000    0.000    0.000    0.000 utils.py:320(_text_width)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:16(__init__)
        1    0.000    0.000    0.000    0.000 profilers.py:251(stop)
        3    0.000    0.000    0.000    0.000 std.py:1402(<genexpr>)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:26(__exit__)
        2    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        4    0.000    0.000    0.000    0.000 types.py:171(__get__)
        2    0.000    0.000    0.000    0.000 std.py:1139(_comparable)
        1    0.000    0.000    0.000    0.000 supporters.py:82(mean)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.sorted}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 supporters.py:94(_agg_memory)
        4    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 _weakrefset.py:52(_commit_removals)
        1    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        4    0.000    0.000    0.000    0.000 enum.py:753(value)
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        2    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 std.py:1304(refresh)
        2    0.000    0.000    0.000    0.000 {method 'keys' of 'collections.OrderedDict' objects}
        2    0.000    0.000    0.000    0.000 base.py:146(on_validation_end)
        2    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 utils.py:321(<genexpr>)
        1    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 typing.py:1149(cast)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_start
         217 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 callback_hook.py:109(on_train_start)
        1    0.000    0.000    0.001    0.001 progress.py:317(on_train_start)
        1    0.000    0.000    0.001    0.001 progress.py:268(init_train_tqdm)
        1    0.000    0.000    0.000    0.000 asyncio.py:22(__init__)
        1    0.000    0.000    0.000    0.000 std.py:838(__init__)
        1    0.000    0.000    0.000    0.000 std.py:1304(refresh)
        1    0.000    0.000    0.000    0.000 std.py:1436(display)
        1    0.000    0.000    0.000    0.000 std.py:1136(__repr__)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:77(on_train_start)
        1    0.000    0.000    0.000    0.000 std.py:346(print_status)
        2    0.000    0.000    0.000    0.000 utils.py:273(_screen_shape_linux)
        1    0.000    0.000    0.000    0.000 std.py:560(__new__)
        1    0.000    0.000    0.000    0.000 std.py:353(format_meter)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:166(_find_names)
        1    0.000    0.000    0.000    0.000 utils.py:324(disp_len)
        1    0.000    0.000    0.000    0.000 utils.py:320(_text_width)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
        4    0.000    0.000    0.000    0.000 properties.py:259(get_model)
       29    0.000    0.000    0.000    0.000 utils.py:321(<genexpr>)
        4    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        1    0.000    0.000    0.000    0.000 std.py:1420(format_dict)
        4    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        2    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        1    0.000    0.000    0.000    0.000 std.py:340(fp_write)
        4    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        1    0.000    0.000    0.000    0.000 utils.py:154(__init__)
        2    0.000    0.000    0.000    0.000 utils.py:141(inner)
        4    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        1    0.000    0.000    0.000    0.000 _monitor.py:93(report)
        1    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        3    0.000    0.000    0.000    0.000 std.py:104(acquire)
        1    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        3    0.000    0.000    0.000    0.000 std.py:108(release)
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
        1    0.000    0.000    0.000    0.000 std.py:289(format_interval)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
       28    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        3    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 utils.py:207(_supports_unicode)
        9    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profilers.py:59(profile)
        2    0.000    0.000    0.000    0.000 utils.py:163(__eq__)
        4    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        1    0.000    0.000    0.000    0.000 progress.py:148(on_train_start)
        1    0.000    0.000    0.000    0.000 progress.py:246(is_disabled)
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 profilers.py:251(stop)
        3    0.000    0.000    0.000    0.000 std.py:229(__init__)
        2    0.000    0.000    0.000    0.000 utils.py:136(disable_on_exception)
        3    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        3    0.000    0.000    0.000    0.000 utils.py:101(wrapper_setattr)
        1    0.000    0.000    0.000    0.000 utils.py:105(__init__)
        1    0.000    0.000    0.000    0.000 utils.py:193(_is_utf)
        1    0.000    0.000    0.000    0.000 {built-in method utcfromtimestamp}
        1    0.000    0.000    0.000    0.000 std.py:1143(__hash__)
        1    0.000    0.000    0.000    0.000 std.py:330(status_printer)
        1    0.000    0.000    0.000    0.000 progress.py:242(is_enabled)
        1    0.000    0.000    0.000    0.000 std.py:1133(__del__)
        1    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        3    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 threading.py:513(is_set)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:112(<dictcomp>)
        1    0.000    0.000    0.000    0.000 std.py:657(get_lock)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:111(<dictcomp>)
        3    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x55df9fb619a0}
        3    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        5    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        3    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 utils.py:223(_screen_shape_wrapper)
        1    0.000    0.000    0.000    0.000 std.py:234(__call__)
        1    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        1    0.000    0.000    0.000    0.000 progress.py:234(refresh_rate)
        1    0.000    0.000    0.000    0.000 std.py:1248(close)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 progress.py:73(train_batch_idx)
        1    0.000    0.000    0.000    0.000 progress.py:238(process_position)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 base.py:126(on_train_start)
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_epoch_start
         1545 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 callback_hook.py:99(on_epoch_start)
        1    0.000    0.000    0.001    0.001 progress.py:321(on_epoch_start)
        2    0.000    0.000    0.001    0.000 std.py:1304(refresh)
        2    0.000    0.000    0.001    0.000 std.py:1436(display)
        2    0.000    0.000    0.001    0.000 std.py:1136(__repr__)
        2    0.000    0.000    0.000    0.000 std.py:353(format_meter)
        1    0.000    0.000    0.000    0.000 std.py:1337(reset)
        6    0.000    0.000    0.000    0.000 utils.py:324(disp_len)
        6    0.000    0.000    0.000    0.000 utils.py:320(_text_width)
        7    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
        1    0.000    0.000    0.000    0.000 std.py:1356(set_description)
      651    0.000    0.000    0.000    0.000 utils.py:321(<genexpr>)
        2    0.000    0.000    0.000    0.000 std.py:346(print_status)
        2    0.000    0.000    0.000    0.000 utils.py:332(disp_trim)
      645    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        2    0.000    0.000    0.000    0.000 std.py:1420(format_dict)
       10    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        2    0.000    0.000    0.000    0.000 utils.py:273(_screen_shape_linux)
        2    0.000    0.000    0.000    0.000 std.py:340(fp_write)
        5    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        4    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        4    0.000    0.000    0.000    0.000 utils.py:214(_is_ascii)
        4    0.000    0.000    0.000    0.000 utils.py:141(inner)
        1    0.000    0.000    0.000    0.000 progress.py:106(total_val_batches)
        5    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        5    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        2    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        2    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        2    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
        5    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        1    0.000    0.000    0.000    0.000 properties.py:190(disable_validation)
        1    0.000    0.000    0.000    0.000 properties.py:195(enable_validation)
        2    0.000    0.000    0.000    0.000 std.py:188(__format__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 std.py:289(format_interval)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        2    0.000    0.000    0.000    0.000 std.py:108(release)
        2    0.000    0.000    0.000    0.000 std.py:104(acquire)
        2    0.000    0.000    0.000    0.000 std.py:155(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       42    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
        5    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        1    0.000    0.000    0.000    0.000 profilers.py:59(profile)
        6    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        1    0.000    0.000    0.000    0.000 profilers.py:251(stop)
       11    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        2    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        2    0.000    0.000    0.000    0.000 {built-in method utcfromtimestamp}
        7    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 progress.py:97(total_train_batches)
        2    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        2    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        2    0.000    0.000    0.000    0.000 std.py:234(__call__)
        2    0.000    0.000    0.000    0.000 std.py:169(colour)
        3    0.000    0.000    0.000    0.000 std.py:229(__init__)
        5    0.000    0.000    0.000    0.000 progress.py:69(trainer)
        2    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        6    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        2    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 progress.py:390(convert_inf)
        3    0.000    0.000    0.000    0.000 {built-in method time.time}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 progress.py:151(on_epoch_start)
        2    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 std.py:165(colour)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        2    0.000    0.000    0.000    0.000 base.py:94(on_epoch_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_epoch_start
         48 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:69(on_train_epoch_start)
        4    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        4    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        4    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        4    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        4    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        1    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        4    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        1    0.000    0.000    0.000    0.000 profilers.py:59(profile)
        1    0.000    0.000    0.000    0.000 profilers.py:251(stop)
        1    0.000    0.000    0.000    0.000 lr_monitor.py:125(on_train_epoch_start)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 base.py:70(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: run_training_epoch
         18 function calls in 78.311 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000   78.311   78.311 training_loop.py:549(run_training_epoch)
        1    0.000    0.000   78.311   78.311 profilers.py:78(profile_iterable)
        1    0.000    0.000   78.311   78.311 profilers.py:246(start)
        1   78.311   78.311   78.311   78.311 {method 'enable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 training_loop.py:88(num_optimizers)
        1    0.000    0.000    0.000    0.000 training_loop.py:293(get_optimizers_iterable)
        1    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        1    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        1    0.000    0.000    0.000    0.000 data_connector.py:35(get_profiled_train_dataloader)
        1    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        1    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        1    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        1    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        1    0.000    0.000    0.000    0.000 training_loop.py:558(<listcomp>)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 accelerator.py:87(process_dataloader)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.iter}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}



Profile stats for: get_train_batch
         18440 function calls (18104 primitive calls) in 4.057 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
  432/100    0.010    0.000    4.057    0.041 {built-in method builtins.next}
      100    0.001    0.000    4.047    0.040 data_connector.py:42(_with_is_last)
      101    0.002    0.000    2.401    0.024 dataloader.py:517(__next__)
      101    0.001    0.000    2.253    0.022 dataloader.py:1156(_next_data)
      101    0.001    0.000    2.205    0.022 dataloader.py:1123(_get_data)
      101    0.000    0.000    2.203    0.022 dataloader.py:977(_try_get_data)
      101    0.001    0.000    2.202    0.022 queue.py:153(get)
      383    2.201    0.006    2.201    0.006 {method 'acquire' of '_thread.lock' objects}
       16    0.000    0.000    2.201    0.138 threading.py:270(wait)
      4/1    0.000    0.000    1.645    1.645 {built-in method builtins.iter}
        1    0.000    0.000    1.645    1.645 dataloader.py:346(__iter__)
        1    0.000    0.000    1.645    1.645 dataloader.py:300(_get_iterator)
        1    0.001    0.001    1.645    1.645 dataloader.py:877(__init__)
      117    0.002    0.000    1.248    0.011 dataloader.py:1205(_try_put_index)
      117    0.000    0.000    1.224    0.010 dataloader.py:511(_next_index)
      118    0.004    0.000    1.224    0.010 sampler.py:227(__iter__)
     1872    0.003    0.000    1.219    0.001 sampler.py:145(__iter__)
        1    0.000    0.000    1.201    1.201 dataloader.py:946(_reset)
        1    0.000    0.000    1.176    1.176 _tensor.py:632(__iter__)
        1    1.176    1.176    1.176    1.176 {method 'unbind' of 'torch._C._TensorBase' objects}
        8    0.000    0.000    0.434    0.054 process.py:110(start)
        8    0.000    0.000    0.433    0.054 context.py:222(_Popen)
        8    0.000    0.000    0.433    0.054 context.py:274(_Popen)
        8    0.000    0.000    0.433    0.054 popen_fork.py:15(__init__)
        8    0.001    0.000    0.432    0.054 popen_fork.py:66(_launch)
        8    0.431    0.054    0.431    0.054 {built-in method posix.fork}
      101    0.000    0.000    0.142    0.001 profiler.py:438(__exit__)
      101    0.142    0.001    0.142    0.001 {built-in method torch._ops.profiler._record_function_exit}
      101    0.000    0.000    0.047    0.000 dataloader.py:1225(_process_data)
     1872    0.024    0.000    0.025    0.000 dataset.py:360(__getitem__)
      117    0.001    0.000    0.022    0.000 queues.py:80(put)
      218    0.001    0.000    0.018    0.000 threading.py:341(notify)
      125    0.016    0.000    0.016    0.000 {method 'release' of '_thread.lock' objects}
        1    0.015    0.015    0.015    0.015 {built-in method randperm}
        9    0.001    0.000    0.007    0.001 context.py:100(Queue)
        9    0.001    0.000    0.006    0.001 queues.py:36(__init__)
       32    0.002    0.000    0.005    0.000 synchronize.py:50(__init__)
       19    0.000    0.000    0.004    0.000 context.py:65(Lock)
       19    0.000    0.000    0.004    0.000 synchronize.py:161(__init__)
        9    0.000    0.000    0.002    0.000 threading.py:834(start)
        8    0.000    0.000    0.002    0.000 queues.py:158(_start_thread)
      101    0.001    0.000    0.002    0.000 profiler.py:434(__enter__)
       32    0.000    0.000    0.002    0.000 __init__.py:8(_make_name)
        9    0.000    0.000    0.002    0.000 threading.py:540(wait)
      101    0.001    0.000    0.002    0.000 profiler.py:426(__init__)
      101    0.002    0.000    0.002    0.000 {built-in method torch._ops.profiler._record_function_enter}
       32    0.000    0.000    0.002    0.000 tempfile.py:144(__next__)
      101    0.001    0.000    0.001    0.000 {built-in method zeros}
       32    0.000    0.000    0.001    0.000 tempfile.py:147(<listcomp>)
      101    0.001    0.000    0.001    0.000 threading.py:1071(is_alive)
      256    0.000    0.000    0.001    0.000 random.py:285(choice)
        9    0.000    0.000    0.001    0.000 context.py:85(BoundedSemaphore)
       41    0.000    0.000    0.001    0.000 util.py:171(register_after_fork)
        9    0.001    0.000    0.001    0.000 {built-in method _thread.start_new_thread}
        9    0.000    0.000    0.001    0.000 synchronize.py:144(__init__)
       16    0.001    0.000    0.001    0.000 util.py:186(__init__)
        8    0.000    0.000    0.001    0.000 process.py:80(__init__)
        1    0.000    0.000    0.001    0.001 context.py:90(Event)
        1    0.000    0.000    0.001    0.001 synchronize.py:323(__init__)
       41    0.000    0.000    0.001    0.000 weakref.py:159(__setitem__)
        9    0.000    0.000    0.001    0.000 threading.py:761(__init__)
2483/2482    0.001    0.000    0.001    0.000 {built-in method builtins.len}
        9    0.000    0.000    0.001    0.000 queues.py:67(_after_fork)
        9    0.000    0.000    0.000    0.000 connection.py:516(Pipe)
     1982    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      227    0.000    0.000    0.000    0.000 threading.py:246(__enter__)
        4    0.000    0.000    0.000    0.000 context.py:80(Semaphore)
        4    0.000    0.000    0.000    0.000 synchronize.py:125(__init__)
      101    0.000    0.000    0.000    0.000 threading.py:1017(_wait_for_tstate_lock)
      227    0.000    0.000    0.000    0.000 threading.py:249(__exit__)
      256    0.000    0.000    0.000    0.000 random.py:250(_randbelow_with_getrandbits)
        1    0.000    0.000    0.000    0.000 context.py:75(Condition)
      234    0.000    0.000    0.000    0.000 threading.py:261(_is_owned)
        1    0.000    0.000    0.000    0.000 synchronize.py:212(__init__)
      100    0.000    0.000    0.000    0.000 profilers.py:251(stop)
     1888    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
      117    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        8    0.000    0.000    0.000    0.000 process.py:61(_cleanup)
       22    0.000    0.000    0.000    0.000 threading.py:222(__init__)
      101    0.000    0.000    0.000    0.000 queue.py:216(_get)
      108    0.000    0.000    0.000    0.000 queue.py:208(_qsize)
        8    0.000    0.000    0.000    0.000 __init__.py:227(_releaseLock)
       25    0.000    0.000    0.000    0.000 {built-in method posix.pipe}
       17    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)
       28    0.000    0.000    0.000    0.000 popen_fork.py:24(poll)
       10    0.000    0.000    0.000    0.000 threading.py:505(__init__)
       18    0.000    0.000    0.000    0.000 connection.py:117(__init__)
        8    0.000    0.000    0.000    0.000 util.py:433(_flush_std_streams)
        1    0.000    0.000    0.000    0.000 dataloader.py:485(__init__)
       60    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:389(parent)
      133    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
       28    0.000    0.000    0.000    0.000 {built-in method posix.waitpid}
       41    0.000    0.000    0.000    0.000 weakref.py:323(__new__)
       32    0.000    0.000    0.000    0.000 tempfile.py:133(rng)
      227    0.000    0.000    0.000    0.000 {method '__enter__' of '_thread.lock' objects}
      101    0.000    0.000    0.000    0.000 {method 'popleft' of 'collections.deque' objects}
      227    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
      119    0.000    0.000    0.000    0.000 threading.py:513(is_set)
       40    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
       41    0.000    0.000    0.000    0.000 weakref.py:328(__init__)
       16    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 queue.py:33(__init__)
        8    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
      105    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
      439    0.000    0.000    0.000    0.000 {method 'getrandbits' of '_random.Random' objects}
      109    0.000    0.000    0.000    0.000 {method 'remove' of 'collections.deque' objects}
        1    0.000    0.000    0.000    0.000 __init__.py:477(current_device)
      108    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._set_worker_pids}
       16    0.000    0.000    0.000    0.000 {built-in method posix.close}
      256    0.000    0.000    0.000    0.000 {method 'bit_length' of 'int' objects}
       25    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
       32    0.000    0.000    0.000    0.000 synchronize.py:90(_make_methods)
       36    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
      108    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
        9    0.000    0.000    0.000    0.000 threading.py:1177(_make_invoke_excepthook)
       16    0.000    0.000    0.000    0.000 threading.py:258(_acquire_restore)
      100    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'random_' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 dataloader.py:941(<genexpr>)
        1    0.000    0.000    0.000    0.000 __init__.py:188(_lazy_init)
       16    0.000    0.000    0.000    0.000 process.py:94(<genexpr>)
       41    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x55df9fb619a0}
        8    0.000    0.000    0.000    0.000 {method 'copy' of 'dict' objects}
       18    0.000    0.000    0.000    0.000 context.py:233(get_context)
       32    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 dataloader.py:506(_reset)
        1    0.000    0.000    0.000    0.000 __init__.py:146(is_initialized)
       60    0.000    0.000    0.000    0.000 {method 'rpartition' of 'str' objects}
       73    0.000    0.000    0.000    0.000 util.py:48(debug)
        8    0.000    0.000    0.000    0.000 process.py:234(ident)
       10    0.000    0.000    0.000    0.000 threading.py:1306(current_thread)
        1    0.000    0.000    0.000    0.000 {built-in method empty}
        8    0.000    0.000    0.000    0.000 queues.py:150(cancel_join_thread)
        8    0.000    0.000    0.000    0.000 process.py:189(name)
        8    0.000    0.000    0.000    0.000 __init__.py:218(_acquireLock)
        1    0.000    0.000    0.000    0.000 dataloader.py:406(check_worker_number_rationality)
        9    0.000    0.000    0.000    0.000 threading.py:1110(daemon)
       16    0.000    0.000    0.000    0.000 threading.py:255(_release_save)
        1    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
        9    0.000    0.000    0.000    0.000 threading.py:1095(daemon)
        1    0.000    0.000    0.000    0.000 __init__.py:74(is_available)
       42    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       32    0.000    0.000    0.000    0.000 context.py:197(get_start_method)
       33    0.000    0.000    0.000    0.000 context.py:187(get_context)
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 threading.py:734(_newname)
       21    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_getDevice}
        1    0.000    0.000    0.000    0.000 {built-in method posix.sched_getaffinity}
        1    0.000    0.000    0.000    0.000 queue.py:205(_init)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_isInBadFork}
        8    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 dataset.py:365(__len__)
        1    0.000    0.000    0.000    0.000 signal_handling.py:47(_set_SIGCHLD_handler)
       16    0.000    0.000    0.000    0.000 process.py:99(_check_closed)
        8    0.000    0.000    0.000    0.000 process.py:205(daemon)
       10    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_getDeviceCount}
        8    0.000    0.000    0.000    0.000 {method 'clear' of 'collections.deque' objects}
        1    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 synchronize.py:235(_make_methods)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 dataloader.py:365(_index_sampler)
        1    0.000    0.000    0.000    0.000 dataloader.py:962(<listcomp>)
        2    0.000    0.000    0.000    0.000 dataloader.py:361(_auto_collation)
        1    0.000    0.000    0.000    0.000 dataloader.py:307(multiprocessing_context)
        1    0.000    0.000    0.000    0.000 dataloader.py:503(__iter__)



Profile stats for: run_training_batch
         1400 function calls in 71.468 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.001    0.000   71.468    0.715 training_loop.py:654(run_training_batch)
      100    0.000    0.000   71.466    0.715 trainer.py:880(call_hook)
      100    0.000    0.000   71.459    0.715 contextlib.py:108(__enter__)
      100    0.000    0.000   71.459    0.715 {built-in method builtins.next}
      100    0.000    0.000   71.459    0.715 profilers.py:59(profile)
      100    0.000    0.000   71.459    0.715 profilers.py:246(start)
      100   71.459    0.715   71.459    0.715 {method 'enable' of '_lsprof.Profiler' objects}
      100    0.000    0.000    0.007    0.000 contextlib.py:238(helper)
      100    0.006    0.000    0.006    0.000 contextlib.py:82(__init__)
      100    0.000    0.000    0.000    0.000 training_loop.py:293(get_optimizers_iterable)
      100    0.000    0.000    0.000    0.000 trainer.py:863(_reset_result_and_set_hook_fx_name)
      100    0.000    0.000    0.000    0.000 training_loop.py:663(<listcomp>)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      100    0.000    0.000    0.000    0.000 {built-in method builtins.len}



Profile stats for: on_batch_start
         4600 function calls in 0.020 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.001    0.000    0.018    0.000 callback_hook.py:129(on_batch_start)
      400    0.000    0.000    0.018    0.000 properties.py:259(get_model)
      400    0.000    0.000    0.017    0.000 model_connector.py:48(get_model)
      400    0.000    0.000    0.017    0.000 model_connector.py:51(_get_reference_model)
      400    0.000    0.000    0.017    0.000 ddp_accelerator.py:359(get_reference_model)
      400    0.016    0.000    0.016    0.000 ddp_plugin.py:123(get_model_from_plugin)
      500    0.001    0.000    0.001    0.000 module.py:1164(__getattr__)
      100    0.000    0.000    0.001    0.000 model_utils.py:21(is_overridden)
      300    0.000    0.000    0.001    0.000 {built-in method builtins.hasattr}
      100    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      100    0.000    0.000    0.000    0.000 profilers.py:59(profile)
      500    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      100    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      100    0.000    0.000    0.000    0.000 profilers.py:251(stop)
      300    0.000    0.000    0.000    0.000 base.py:102(on_batch_start)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      100    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_batch_start
         7412 function calls (7372 primitive calls) in 0.026 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.001    0.000    0.024    0.000 callback_hook.py:139(on_train_batch_start)
      100    0.000    0.000    0.021    0.000 lr_monitor.py:114(on_train_batch_start)
    50/10    0.000    0.000    0.021    0.002 distributed.py:36(wrapped_fn)
       10    0.000    0.000    0.021    0.002 tensorboard.py:175(log_metrics)
       40    0.000    0.000    0.019    0.000 writer.py:315(add_scalar)
       40    0.000    0.000    0.016    0.000 writer.py:83(add_summary)
       40    0.000    0.000    0.016    0.000 writer.py:67(add_event)
       40    0.000    0.000    0.016    0.000 event_file_writer.py:107(add_event)
       40    0.000    0.000    0.015    0.000 event_file_writer.py:166(write)
       40    0.000    0.000    0.015    0.000 queue.py:121(put)
       40    0.003    0.000    0.014    0.000 threading.py:341(notify)
       11    0.011    0.001    0.011    0.001 {method 'release' of '_thread.lock' objects}
      400    0.000    0.000    0.002    0.000 properties.py:259(get_model)
       40    0.001    0.000    0.002    0.000 summary.py:233(scalar)
      400    0.000    0.000    0.002    0.000 model_connector.py:48(get_model)
      400    0.000    0.000    0.001    0.000 model_connector.py:51(_get_reference_model)
      400    0.000    0.000    0.001    0.000 ddp_accelerator.py:359(get_reference_model)
      400    0.001    0.000    0.001    0.000 ddp_plugin.py:123(get_model_from_plugin)
       40    0.000    0.000    0.001    0.000 base.py:34(experiment)
      100    0.000    0.000    0.001    0.000 model_utils.py:21(is_overridden)
       40    0.000    0.000    0.001    0.000 _convert_np.py:8(make_np)
       40    0.000    0.000    0.001    0.000 distributed.py:34(rank_zero_only)
      500    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       10    0.000    0.000    0.000    0.000 lr_monitor.py:133(_extract_stats)
      400    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
       40    0.000    0.000    0.000    0.000 functools.py:34(update_wrapper)
       40    0.000    0.000    0.000    0.000 {method 'SerializeToString' of 'google.protobuf.pyext._message.CMessage' objects}
      100    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
       40    0.000    0.000    0.000    0.000 threading.py:246(__enter__)
       40    0.000    0.000    0.000    0.000 {built-in method numpy.array}
       40    0.000    0.000    0.000    0.000 {method '__enter__' of '_thread.lock' objects}
      100    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      100    0.000    0.000    0.000    0.000 profilers.py:59(profile)
      780    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      580    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      100    0.000    0.000    0.000    0.000 lr_monitor.py:198(_should_log)
      100    0.000    0.000    0.000    0.000 profilers.py:251(stop)
       40    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
       40    0.000    0.000    0.000    0.000 numeric.py:1816(isscalar)
       40    0.000    0.000    0.000    0.000 lr_monitor.py:153(_extract_lr)
       40    0.000    0.000    0.000    0.000 functools.py:64(wraps)
       40    0.000    0.000    0.000    0.000 base.py:36(get_experiment)
       40    0.000    0.000    0.000    0.000 queue.py:208(_qsize)
       40    0.000    0.000    0.000    0.000 writer.py:232(_check_caffe2_blob)
       40    0.000    0.000    0.000    0.000 {method 'squeeze' of 'numpy.ndarray' objects}
       40    0.000    0.000    0.000    0.000 threading.py:249(__exit__)
      120    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
       40    0.000    0.000    0.000    0.000 queue.py:212(_put)
      200    0.000    0.000    0.000    0.000 base.py:62(on_train_batch_start)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
       40    0.000    0.000    0.000    0.000 threading.py:261(_is_owned)
       40    0.000    0.000    0.000    0.000 tensorboard.py:125(experiment)
       40    0.000    0.000    0.000    0.000 writer.py:247(_get_file_writer)
      140    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       40    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.lock' objects}
       10    0.000    0.000    0.000    0.000 base.py:330(_add_prefix)
       80    0.000    0.000    0.000    0.000 {built-in method builtins.len}
      100    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
       40    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
       40    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
       40    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
       40    0.000    0.000    0.000    0.000 lr_monitor.py:158(_extract_momentum)
       40    0.000    0.000    0.000    0.000 {built-in method time.time}
       11    0.000    0.000    0.000    0.000 {method 'remove' of 'collections.deque' objects}
       10    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}



Profile stats for: closure
         1000 function calls in 67.698 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.000    0.000   67.698    0.677 training_loop.py:719(train_step_and_backward_closure)
      100    0.000    0.000   67.697    0.677 training_loop.py:812(training_step_and_backward)
      100    0.000    0.000   67.697    0.677 contextlib.py:108(__enter__)
      100    0.000    0.000   67.697    0.677 {built-in method builtins.next}
      100    0.000    0.000   67.697    0.677 profilers.py:59(profile)
      100    0.000    0.000   67.697    0.677 profilers.py:246(start)
      100   67.697    0.677   67.697    0.677 {method 'enable' of '_lsprof.Profiler' objects}
      100    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
      100    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}



Profile stats for: training_step_and_backward
         1600 function calls in 67.695 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.000    0.000   67.695    0.677 training_loop.py:329(training_step)
      100    0.000    0.000   67.694    0.677 contextlib.py:108(__enter__)
      100    0.000    0.000   67.694    0.677 {built-in method builtins.next}
      100    0.000    0.000   67.694    0.677 profilers.py:59(profile)
      100    0.000    0.000   67.694    0.677 profilers.py:246(start)
      100   67.694    0.677   67.694    0.677 {method 'enable' of '_lsprof.Profiler' objects}
      100    0.000    0.000    0.001    0.000 properties.py:259(get_model)
      100    0.000    0.000    0.001    0.000 model_connector.py:48(get_model)
      100    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
      100    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
      100    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
      100    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
      100    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
      100    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      100    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}



Profile stats for: model_forward
         1033572 function calls (873872 primitive calls) in 65.752 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.003    0.000   65.661    0.657 ddp_accelerator.py:157(training_step)
      100    0.003    0.000   65.657    0.657 ddp_accelerator.py:166(_step)
44200/100    0.232    0.000   65.420    0.654 module.py:1096(_call_impl)
      100    0.004    0.000   65.416    0.654 data_parallel.py:163(forward)
      100    0.002    0.000   65.047    0.650 mmcl.py:157(training_step)
      100    0.009    0.000   65.035    0.650 mmcl.py:130(forward)
      200    0.085    0.000   60.905    0.305 mmcl.py:87(infer)
      200    7.324    0.037   55.058    0.275 vision_transformer.py:557(visual_embed)
     3200   38.946    0.012   38.946    0.012 {built-in method multinomial}
     2400    0.166    0.000    5.330    0.002 vision_transformer.py:370(forward)
      200    0.040    0.000    5.041    0.025 vision_transformer.py:573(<listcomp>)
      200    0.008    0.000    3.669    0.018 objectives.py:91(compute_mlm)
     3400    0.035    0.000    3.574    0.001 functional.py:3542(interpolate)
     3200    3.502    0.001    3.502    0.001 {built-in method torch._C._nn.upsample_bilinear2d}
      400    0.023    0.000    3.220    0.008 metric.py:147(forward)
     2400    1.207    0.001    3.016    0.001 vision_transformer.py:309(forward)
      800    0.012    0.000    2.811    0.004 metric.py:242(reset)
     4300    2.720    0.001    2.720    0.001 {method 'to' of 'torch._C._TensorBase' objects}
      200    0.001    0.000    1.998    0.010 vision_transformer.py:404(forward)
      200    0.001    0.000    1.995    0.010 conv.py:445(forward)
      200    0.013    0.000    1.994    0.010 conv.py:437(_conv_forward)
      200    1.981    0.010    1.981    0.010 {built-in method conv2d}
    10600    0.063    0.000    1.812    0.000 linear.py:102(forward)
    10600    0.025    0.000    1.718    0.000 functional.py:1832(linear)
    10600    1.690    0.000    1.690    0.000 {built-in method torch._C._nn.linear}
     2400    0.051    0.000    1.618    0.001 vision_transformer.py:279(forward)
     3200    0.032    0.000    1.170    0.000 functional.py:4111(_pad)
     3200    1.131    0.000    1.131    0.000 {built-in method constant_pad_nd}
    10000    0.028    0.000    0.872    0.000 dropout.py:57(forward)
    10000    0.098    0.000    0.844    0.000 functional.py:1152(dropout)
    10000    0.693    0.000    0.693    0.000 {built-in method dropout}
      200    0.589    0.003    0.589    0.003 vision_transformer.py:620(<listcomp>)
     5400    0.020    0.000    0.462    0.000 normalization.py:188(forward)
      100    0.058    0.001    0.452    0.005 objectives.py:110(compute_cl)
     5400    0.029    0.000    0.432    0.000 functional.py:2332(layer_norm)
      200    0.428    0.002    0.428    0.002 vision_transformer.py:621(<listcomp>)
     5400    0.394    0.000    0.394    0.000 {built-in method layer_norm}
     4272    0.387    0.000    0.387    0.000 {built-in method cat}
      800    0.004    0.000    0.346    0.000 metric.py:197(wrapped_func)
      200    0.047    0.000    0.311    0.002 heads.py:58(forward)
      400    0.241    0.001    0.301    0.001 my_metrics.py:11(update)
     2400    0.283    0.000    0.283    0.000 {method 'masked_fill' of 'torch._C._TensorBase' objects}
     6600    0.009    0.000    0.282    0.000 _tensor.py:25(wrapped)
      200    0.034    0.000    0.281    0.001 modeling_bert.py:183(forward)
     6600    0.014    0.000    0.272    0.000 _tensor.py:544(__rsub__)
     6600    0.256    0.000    0.256    0.000 {built-in method rsub}
      100    0.002    0.000    0.221    0.002 distributed.py:1361(_sync_params)
     4800    0.214    0.000    0.214    0.000 {method 'reshape' of 'torch._C._TensorBase' objects}
      100    0.001    0.000    0.204    0.002 ddp_plugin.py:101(on_before_forward)
     1600    0.016    0.000    0.204    0.000 copy.py:128(deepcopy)
      100    0.000    0.000    0.202    0.002 hooks.py:505(transfer_batch_to_device)
      100    0.001    0.000    0.202    0.002 apply_func.py:94(move_data_to_device)
 5100/100    0.008    0.000    0.201    0.002 apply_func.py:30(apply_to_collection)
  500/100    0.035    0.000    0.198    0.002 apply_func.py:60(<listcomp>)
      100    0.002    0.000    0.196    0.002 apply_func.py:53(<dictcomp>)
     2600    0.016    0.000    0.195    0.000 functional.py:1544(gelu)
     2400    0.003    0.000    0.188    0.000 activation.py:651(forward)
     1600    0.071    0.000    0.175    0.000 _tensor.py:81(__deepcopy__)
      100    0.001    0.000    0.169    0.002 distributed.py:741(_assign_modules_buffers)
     2600    0.169    0.000    0.169    0.000 {built-in method torch._C._nn.gelu}
     1000    0.005    0.000    0.169    0.000 sparse.py:157(forward)
      100    0.000    0.000    0.166    0.002 distributed.py:750(<listcomp>)
      500    0.001    0.000    0.166    0.000 module.py:1571(named_buffers)
      500    0.025    0.000    0.165    0.000 module.py:1486(_named_members)
     2400    0.163    0.000    0.163    0.000 {method 'softmax' of 'torch._C._TensorBase' objects}
     1000    0.002    0.000    0.163    0.000 functional.py:1950(embedding)
     1000    0.160    0.000    0.160    0.000 {built-in method embedding}
      200    0.010    0.000    0.149    0.001 heads.py:44(forward)
      100    0.001    0.000    0.138    0.001 distributed.py:945(scatter)
      100    0.001    0.000    0.138    0.001 scatter_gather.py:42(scatter_kwargs)
      200    0.003    0.000    0.137    0.001 container.py:139(forward)
      100    0.000    0.000    0.136    0.001 scatter_gather.py:11(scatter)
 7900/100    0.051    0.000    0.136    0.001 scatter_gather.py:17(scatter_map)
      400    0.005    0.000    0.134    0.000 metric.py:204(wrapped_func)
     1200    0.002    0.000    0.129    0.000 apply_func.py:112(batch_to)
    78400    0.128    0.000    0.128    0.000 module.py:1164(__getattr__)
122700/20500    0.116    0.000    0.122    0.000 module.py:1653(named_modules)
      200    0.010    0.000    0.115    0.001 _tensor.py:520(unique)
      200    0.009    0.000    0.111    0.001 modeling_bert.py:626(forward)
  400/200    0.001    0.000    0.105    0.001 _jit_internal.py:412(fn)
      200    0.001    0.000    0.104    0.001 functional.py:815(_return_output)
      200    0.001    0.000    0.103    0.001 functional.py:660(_unique_impl)
      200    0.102    0.001    0.102    0.001 {built-in method _unique2}
      100    0.001    0.000    0.087    0.001 logger_connector.py:74(cache_logged_metrics)
      100    0.001    0.000    0.086    0.001 epoch_result_store.py:317(cache_result)
      100    0.000    0.000    0.083    0.001 contextlib.py:108(__enter__)
      100    0.000    0.000    0.083    0.001 {built-in method builtins.next}
      100    0.000    0.000    0.083    0.001 profilers.py:59(profile)
      100    0.000    0.000    0.083    0.001 profilers.py:246(start)
      100    0.082    0.001    0.082    0.001 {method 'enable' of '_lsprof.Profiler' objects}
     2400    0.081    0.000    0.081    0.000 {method 'bool' of 'torch._C._TensorBase' objects}
      200    0.002    0.000    0.075    0.000 functional.py:2767(cross_entropy)
     1200    0.021    0.000    0.075    0.000 {built-in method apply}
      200    0.073    0.000    0.073    0.000 {built-in method torch._C._nn.cross_entropy_loss}
    45000    0.065    0.000    0.065    0.000 {built-in method torch._C._get_tracing_state}
      200    0.005    0.000    0.064    0.000 heads.py:27(forward)
     8400    0.050    0.000    0.061    0.000 module.py:1180(__setattr__)
      200    0.009    0.000    0.060    0.000 batchnorm.py:134(forward)
     1200    0.008    0.000    0.054    0.000 _functions.py:87(forward)
     1600    0.004    0.000    0.054    0.000 storage.py:44(__deepcopy__)
     1600    0.019    0.000    0.049    0.000 storage.py:60(clone)
      200    0.017    0.000    0.049    0.000 functional.py:4425(normalize)
      200    0.007    0.000    0.048    0.000 functional.py:2251(batch_norm)
      100    0.001    0.000    0.047    0.000 distributed.py:1331(_distributed_broadcast_coalesced)
      100    0.046    0.000    0.046    0.000 {built-in method torch._C._distributed_c10d._broadcast_coalesced}
     3400    0.044    0.000    0.044    0.000 {built-in method ones}
    94700    0.029    0.000    0.043    0.000 {built-in method builtins.isinstance}
     1200    0.003    0.000    0.040    0.000 comm.py:152(scatter)
      800    0.003    0.000    0.040    0.000 _tensor.py:632(__iter__)
      200    0.039    0.000    0.039    0.000 {built-in method batch_norm}
    13600    0.031    0.000    0.036    0.000 _VF.py:25(__getattr__)
      400    0.035    0.000    0.035    0.000 {method 'nonzero' of 'torch._C._TensorBase' objects}
      500    0.019    0.000    0.034    0.000 lightning.py:192(log)
    24400    0.034    0.000    0.034    0.000 {built-in method torch._C._has_torch_function_unary}
      800    0.034    0.000    0.034    0.000 {method 'unbind' of 'torch._C._TensorBase' objects}
     5400    0.033    0.000    0.033    0.000 {method 'transpose' of 'torch._C._TensorBase' objects}
     1200    0.033    0.000    0.033    0.000 {built-in method torch._C._scatter}
      500    0.031    0.000    0.031    0.000 {built-in method sum}
      400    0.024    0.000    0.031    0.000 my_metrics.py:37(update)
     1400    0.027    0.000    0.027    0.000 {method 'view' of 'torch._C._TensorBase' objects}
     2400    0.003    0.000    0.021    0.000 {built-in method builtins.setattr}
     2400    0.021    0.000    0.021    0.000 {method 'permute' of 'torch._C._TensorBase' objects}
      100    0.020    0.000    0.020    0.000 {built-in method mm}
    33800    0.019    0.000    0.019    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
      200    0.001    0.000    0.019    0.000 _tensor.py:438(norm)
      700    0.019    0.000    0.019    0.000 {method 'sum' of 'torch._C._TensorBase' objects}
      200    0.002    0.000    0.018    0.000 functional.py:1315(norm)
     1600    0.003    0.000    0.018    0.000 __init__.py:265(__init__)
      200    0.017    0.000    0.017    0.000 {method 'max' of 'torch._C._TensorBase' objects}
      200    0.017    0.000    0.017    0.000 {built-in method stack}
    20400    0.014    0.000    0.016    0.000 module.py:1592(<lambda>)
      100    0.001    0.000    0.015    0.000 autocast_mode.py:16(__init__)
      200    0.015    0.000    0.015    0.000 {built-in method norm}
     2100    0.004    0.000    0.015    0.000 grad_mode.py:124(__enter__)
     1600    0.011    0.000    0.015    0.000 _utils.py:7(_get_device_index)
      100    0.013    0.000    0.015    0.000 autocast_mode.py:131(__init__)
    12800    0.003    0.000    0.014    0.000 abc.py:96(__instancecheck__)
     4200    0.011    0.000    0.014    0.000 grad_mode.py:213(__init__)
      200    0.013    0.000    0.013    0.000 {built-in method zeros}
      400    0.013    0.000    0.013    0.000 {method 'argmax' of 'torch._C._TensorBase' objects}
      500    0.004    0.000    0.012    0.000 step_result.py:114(log)
      100    0.001    0.000    0.012    0.000 autocast_mode.py:179(__exit__)
      200    0.012    0.000    0.012    0.000 {built-in method builtins.min}
      200    0.011    0.000    0.011    0.000 {built-in method torch._C._nn.upsample_nearest2d}
    12800    0.007    0.000    0.011    0.000 {built-in method _abc._abc_instancecheck}
    28400    0.011    0.000    0.011    0.000 {method 'get' of 'dict' objects}
      200    0.010    0.000    0.010    0.000 {method 'clamp_min' of 'torch._C._TensorBase' objects}
      100    0.010    0.000    0.010    0.000 {built-in method torch._C.clear_autocast_cache}
    18100    0.009    0.000    0.010    0.000 {built-in method builtins.getattr}
      200    0.010    0.000    0.010    0.000 {method 'long' of 'torch._C._TensorBase' objects}
     1600    0.010    0.000    0.010    0.000 {method 'set_' of 'torch._C._TensorBase' objects}
     1600    0.010    0.000    0.010    0.000 {method 'copy_' of 'torch._C.FloatStorageBase' objects}
     2100    0.009    0.000    0.009    0.000 grad_mode.py:119(__init__)
      100    0.009    0.000    0.009    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
     3400    0.009    0.000    0.009    0.000 {method 'float' of 'torch._C._TensorBase' objects}
     1600    0.008    0.000    0.008    0.000 {method 'new_empty' of 'torch._C._TensorBase' objects}
    13200    0.008    0.000    0.008    0.000 {built-in method builtins.len}
     1700    0.008    0.000    0.008    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
     2100    0.003    0.000    0.008    0.000 grad_mode.py:128(__exit__)
      200    0.006    0.000    0.008    0.000 vision_transformer.py:625(<listcomp>)
      200    0.001    0.000    0.007    0.000 activation.py:97(forward)
     5600    0.005    0.000    0.007    0.000 __init__.py:31(__get__)
      200    0.001    0.000    0.007    0.000 functional.py:337(meshgrid)
    24200    0.007    0.000    0.007    0.000 {built-in method torch._C._has_torch_function_variadic}
      200    0.000    0.000    0.007    0.000 functional.py:1288(relu)
      200    0.002    0.000    0.007    0.000 functional.py:433(_meshgrid)
      200    0.001    0.000    0.007    0.000 activation.py:348(forward)
      200    0.006    0.000    0.006    0.000 {built-in method exp}
      200    0.006    0.000    0.006    0.000 {built-in method relu}
      500    0.004    0.000    0.006    0.000 step_result.py:212(__set_meta)
     4000    0.004    0.000    0.006    0.000 _utils.py:476(_get_device_index)
      200    0.006    0.000    0.006    0.000 {built-in method tanh}
      100    0.006    0.000    0.006    0.000 {built-in method builtins.sum}
     8400    0.005    0.000    0.005    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      400    0.005    0.000    0.005    0.000 {built-in method arange}
      200    0.005    0.000    0.005    0.000 {built-in method zeros_like}
      200    0.005    0.000    0.005    0.000 my_metrics.py:45(compute)
     1600    0.004    0.000    0.005    0.000 copy.py:242(_keep_alive)
      800    0.005    0.000    0.005    0.000 {method 'flatten' of 'torch._C._TensorBase' objects}
    40800    0.004    0.000    0.004    0.000 {method 'items' of 'collections.OrderedDict' objects}
     3300    0.001    0.000    0.004    0.000 abc.py:100(__subclasscheck__)
      200    0.004    0.000    0.004    0.000 {built-in method meshgrid}
    20800    0.004    0.000    0.004    0.000 {method 'add' of 'set' objects}
      100    0.003    0.000    0.004    0.000 data_parallel.py:207(reducer_prepare_for_backwards)
      600    0.004    0.000    0.004    0.000 {method 'expand' of 'torch._C._TensorBase' objects}
      200    0.004    0.000    0.004    0.000 {built-in method full_like}
      600    0.004    0.000    0.004    0.000 device_dtype_mixin.py:38(device)
      200    0.004    0.000    0.004    0.000 my_metrics.py:27(compute)
     6700    0.003    0.000    0.004    0.000 scatter_gather.py:4(is_namedtuple)
     3300    0.003    0.000    0.003    0.000 {built-in method _abc._abc_subclasscheck}
     1300    0.002    0.000    0.003    0.000 __init__.py:74(is_available)
     5600    0.003    0.000    0.003    0.000 {built-in method torch._C._get_cudnn_enabled}
      100    0.003    0.000    0.003    0.000 {method 'contiguous' of 'torch._C._TensorBase' objects}
     1200    0.001    0.000    0.003    0.000 _utils.py:518(_handle_complex)
     1200    0.001    0.000    0.003    0.000 _functions.py:89(<listcomp>)
     6400    0.003    0.000    0.003    0.000 {built-in method torch._C.is_grad_enabled}
      100    0.003    0.000    0.003    0.000 {built-in method clamp}
      100    0.001    0.000    0.003    0.000 vilt_utils.py:163(set_task)
      100    0.001    0.000    0.002    0.000 step_result.py:30(__init__)
      100    0.002    0.000    0.002    0.000 {built-in method log}
     1200    0.001    0.000    0.002    0.000 comm.py:188(<listcomp>)
      200    0.001    0.000    0.002    0.000 vision_transformer.py:626(<listcomp>)
     8800    0.002    0.000    0.002    0.000 {built-in method builtins.id}
     1600    0.002    0.000    0.002    0.000 {method 'storage' of 'torch._C._TensorBase' objects}
     1600    0.002    0.000    0.002    0.000 _tensor.py:1001(grad)
     6800    0.002    0.000    0.002    0.000 {built-in method torch._C._has_torch_function}
      200    0.002    0.000    0.002    0.000 {method 'expand_as' of 'torch._C._TensorBase' objects}
      100    0.001    0.000    0.002    0.000 os.py:678(__setitem__)
      200    0.001    0.000    0.002    0.000 container.py:210(__iter__)
     3900    0.002    0.000    0.002    0.000 {built-in method builtins.hasattr}
     1000    0.001    0.000    0.001    0.000 step_result.py:59(__getitem__)
      100    0.001    0.000    0.001    0.000 contextlib.py:238(helper)
     4700    0.001    0.000    0.001    0.000 scatter_gather.py:28(<listcomp>)
      200    0.001    0.000    0.001    0.000 vision_transformer.py:627(<listcomp>)
     4200    0.001    0.000    0.001    0.000 {built-in method torch._C._set_grad_enabled}
     3200    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      500    0.001    0.000    0.001    0.000 lightning.py:1680(hparams)
      100    0.001    0.000    0.001    0.000 autocast_mode.py:163(__enter__)
     4800    0.001    0.000    0.001    0.000 linear.py:35(forward)
      500    0.001    0.000    0.001    0.000 __init__.py:8(is_available)
      100    0.000    0.000    0.001    0.000 data_parallel.py:220(reducer_reset_hooks)
     1600    0.001    0.000    0.001    0.000 {method 'is_conj' of 'torch._C._TensorBase' objects}
      400    0.001    0.000    0.001    0.000 metric.py:161(<dictcomp>)
      800    0.001    0.000    0.001    0.000 _tensor.py:650(__hash__)
      100    0.000    0.000    0.001    0.000 common.py:5(amp_definitely_not_available)
      100    0.001    0.000    0.001    0.000 {method 'fill_' of 'torch._C._TensorBase' objects}
      100    0.001    0.000    0.001    0.000 contextlib.py:82(__init__)
      100    0.000    0.000    0.001    0.000 __init__.py:62(__eq__)
     1600    0.001    0.000    0.001    0.000 {method 'stride' of 'torch._C._TensorBase' objects}
     3700    0.001    0.000    0.001    0.000 _jit_internal.py:957(is_scripting)
      500    0.001    0.000    0.001    0.000 parsing.py:182(__getattr__)
      200    0.001    0.000    0.001    0.000 container.py:131(__iter__)
     1200    0.001    0.000    0.001    0.000 {built-in method builtins.iter}
     1600    0.001    0.000    0.001    0.000 {method 'is_neg' of 'torch._C._TensorBase' objects}
     1200    0.001    0.000    0.001    0.000 {method 'is_complex' of 'torch._C._TensorBase' objects}
     1300    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_getDeviceCount}
     1600    0.001    0.000    0.001    0.000 {method 'size' of 'torch._C.FloatStorageBase' objects}
     3300    0.001    0.000    0.001    0.000 _collections_abc.py:302(__subclasshook__)
      200    0.001    0.000    0.001    0.000 functional.py:2234(_verify_batch_size)
     1600    0.001    0.000    0.001    0.000 __init__.py:278(__exit__)
     1600    0.001    0.000    0.001    0.000 __init__.py:269(__enter__)
     1600    0.001    0.000    0.001    0.000 {method 'storage_offset' of 'torch._C._TensorBase' objects}
      500    0.001    0.000    0.001    0.000 distributed_c10d.py:386(is_initialized)
      100    0.001    0.000    0.001    0.000 {method 't' of 'torch._C._TensorBase' objects}
      100    0.000    0.000    0.001    0.000 properties.py:259(get_model)
      500    0.001    0.000    0.001    0.000 lightning.py:354(__auto_choose_log_on_step)
      100    0.001    0.000    0.001    0.000 {built-in method posix.putenv}
      100    0.000    0.000    0.001    0.000 model_connector.py:48(get_model)
     1600    0.001    0.000    0.001    0.000 {method 'setdefault' of 'dict' objects}
      400    0.001    0.000    0.001    0.000 scatter_gather.py:25(<listcomp>)
      100    0.001    0.000    0.001    0.000 distributed.py:1338(will_sync_module_buffers)
      500    0.001    0.000    0.001    0.000 {built-in method builtins.max}
      800    0.001    0.000    0.001    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
      100    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
      200    0.000    0.000    0.000    0.000 batchnorm.py:297(_check_input_dim)
      100    0.000    0.000    0.000    0.000 scatter_gather.py:27(<listcomp>)
     1700    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
     1200    0.000    0.000    0.000    0.000 {method 'get_device' of 'torch._C._TensorBase' objects}
      200    0.000    0.000    0.000    0.000 os.py:748(encode)
     1600    0.000    0.000    0.000    0.000 storage.py:13(__init__)
      200    0.000    0.000    0.000    0.000 {built-in method torch._C.get_autocast_gpu_dtype}
     1600    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
      100    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
      200    0.000    0.000    0.000    0.000 types.py:171(__get__)
      500    0.000    0.000    0.000    0.000 lightning.py:366(__auto_choose_log_on_epoch)
      100    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
      100    0.000    0.000    0.000    0.000 vilt_utils.py:164(<listcomp>)
      200    0.000    0.000    0.000    0.000 _reduction.py:7(get_enum)
      100    0.000    0.000    0.000    0.000 training_loop.py:904(build_train_args)
      100    0.000    0.000    0.000    0.000 distributed.py:754(<listcomp>)
      100    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
      400    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
     1000    0.000    0.000    0.000    0.000 {function Result.__getitem__ at 0x7efa9d04b940}
      100    0.000    0.000    0.000    0.000 mmcl.py:160(<listcomp>)
      200    0.000    0.000    0.000    0.000 enum.py:753(value)
      200    0.000    0.000    0.000    0.000 {built-in method torch._C.set_autocast_enabled}
      400    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 ddp_plugin.py:95(is_running_single_process_per_device)
      200    0.000    0.000    0.000    0.000 {built-in method torch._C.set_autocast_cache_enabled}
      200    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
      200    0.000    0.000    0.000    0.000 {built-in method torch._C.set_autocast_gpu_dtype}
      200    0.000    0.000    0.000    0.000 {built-in method torch._C.is_autocast_cache_enabled}
      100    0.000    0.000    0.000    0.000 {built-in method torch._C.is_autocast_enabled}
      100    0.000    0.000    0.000    0.000 {built-in method torch._C.autocast_decrement_nesting}
      200    0.000    0.000    0.000    0.000 scatter_gather.py:49(<genexpr>)
      100    0.000    0.000    0.000    0.000 {built-in method torch._C.autocast_increment_nesting}
      200    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}



Profile stats for: training_step_end
         2400 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.001    0.000    0.001    0.000 model_utils.py:21(is_overridden)
      100    0.000    0.000    0.001    0.000 properties.py:259(get_model)
      500    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
      100    0.000    0.000    0.001    0.000 model_connector.py:48(get_model)
      100    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
      100    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
      100    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
      100    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      100    0.000    0.000    0.000    0.000 profilers.py:59(profile)
      100    0.000    0.000    0.000    0.000 profilers.py:251(stop)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      100    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
      300    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      100    0.000    0.000    0.000    0.000 accelerator.py:78(training_step_end)
      100    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: model_backward
         66003 function calls in 1.822 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.002    0.000    1.821    0.018 training_loop.py:841(backward)
      100    0.001    0.000    1.815    0.018 accelerator.py:90(backward)
      100    0.004    0.000    1.814    0.018 native_amp.py:39(backward)
      100    0.001    0.000    1.734    0.017 lightning.py:1138(backward)
      100    0.002    0.000    1.733    0.017 _tensor.py:251(backward)
      100    0.001    0.000    1.732    0.017 __init__.py:69(backward)
      100    1.726    0.017    1.726    0.017 {method 'run_backward' of 'torch._C._EngineBase' objects}
      100    0.004    0.000    0.068    0.001 grad_scaler.py:230(unscale_)
      100    0.017    0.000    0.049    0.000 grad_scaler.py:190(_unscale_grads_)
    27200    0.015    0.000    0.018    0.000 _tensor.py:1001(grad)
      200    0.001    0.000    0.006    0.000 grad_scaler.py:18(get)
      300    0.006    0.000    0.006    0.000 {method 'to' of 'torch._C._TensorBase' objects}
      100    0.005    0.000    0.005    0.000 {method 'reciprocal' of 'torch._C._TensorBase' objects}
      100    0.004    0.000    0.004    0.000 {built-in method _amp_foreach_non_finite_check_and_unscale_}
      100    0.004    0.000    0.004    0.000 {method 'double' of 'torch._C._TensorBase' objects}
      100    0.001    0.000    0.004    0.000 __init__.py:29(_make_grads)
      100    0.003    0.000    0.004    0.000 grad_scaler.py:146(scale)
      102    0.003    0.000    0.003    0.000 {built-in method full}
      100    0.003    0.000    0.003    0.000 {built-in method ones_like}
    27300    0.003    0.000    0.003    0.000 {built-in method torch._C._has_torch_function_unary}
      100    0.002    0.000    0.002    0.000 {method 'float' of 'torch._C._TensorBase' objects}
      200    0.001    0.000    0.002    0.000 training_loop.py:887(should_accumulate)
      100    0.001    0.000    0.001    0.000 training_loop.py:519(track_and_norm_grad)
      100    0.001    0.000    0.001    0.000 debugging.py:56(track_event)
      100    0.000    0.000    0.001    0.000 properties.py:259(get_model)
      100    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
      100    0.000    0.000    0.001    0.000 model_connector.py:48(get_model)
      100    0.001    0.000    0.001    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
      100    0.000    0.000    0.001    0.000 grad_mode.py:124(__enter__)
      100    0.000    0.000    0.001    0.000 model_connector.py:51(_get_reference_model)
      100    0.000    0.000    0.001    0.000 {built-in method builtins.next}
     3600    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      100    0.001    0.000    0.001    0.000 parsing.py:188(__setattr__)
      100    0.001    0.000    0.001    0.000 grad_mode.py:119(__init__)
      100    0.000    0.000    0.001    0.000 ddp_accelerator.py:359(get_reference_model)
      100    0.001    0.000    0.001    0.000 grad_scaler.py:37(_refresh_per_optimizer_state)
      200    0.000    0.000    0.001    0.000 grad_mode.py:213(__init__)
      100    0.000    0.000    0.001    0.000 profilers.py:59(profile)
      100    0.000    0.000    0.001    0.000 ddp_plugin.py:123(get_model_from_plugin)
      100    0.000    0.000    0.000    0.000 grad_mode.py:128(__exit__)
      200    0.000    0.000    0.000    0.000 training_loop.py:881(_accumulated_batches_reached)
      200    0.000    0.000    0.000    0.000 grad_scaler.py:13(__init__)
      100    0.000    0.000    0.000    0.000 profilers.py:251(stop)
      700    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      100    0.000    0.000    0.000    0.000 grad_scaler.py:200(<lambda>)
      100    0.000    0.000    0.000    0.000 grad_scaler.py:135(_check_scale_growth_tracker)
      100    0.000    0.000    0.000    0.000 training_loop.py:527(_track_gradient_norm)
      100    0.000    0.000    0.000    0.000 accelerator.py:114(clip_gradients)
      200    0.000    0.000    0.000    0.000 training_loop.py:884(_num_training_batches_reached)
        1    0.000    0.000    0.000    0.000 grad_scaler.py:141(_lazy_init_scale_growth_tracker)
      100    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
      100    0.000    0.000    0.000    0.000 __init__.py:61(_tensor_or_tensors_to_tuple)
      300    0.000    0.000    0.000    0.000 {built-in method torch._C.is_grad_enabled}
      300    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      200    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      100    0.000    0.000    0.000    0.000 parsing.py:182(__getattr__)
      100    0.000    0.000    0.000    0.000 {built-in method time.time}
      100    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
      100    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
      100    0.000    0.000    0.000    0.000 _jit_internal.py:957(is_scripting)
      100    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 {built-in method builtins.len}



Profile stats for: on_after_backward
         4800 function calls in 0.007 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      400    0.002    0.000    0.004    0.000 properties.py:259(get_model)
      100    0.001    0.000    0.003    0.000 callback_hook.py:213(on_after_backward)
      400    0.000    0.000    0.002    0.000 model_connector.py:48(get_model)
      400    0.000    0.000    0.002    0.000 model_connector.py:51(_get_reference_model)
      400    0.000    0.000    0.001    0.000 ddp_accelerator.py:359(get_reference_model)
      100    0.001    0.000    0.001    0.000 model_utils.py:21(is_overridden)
      400    0.001    0.000    0.001    0.000 ddp_plugin.py:123(get_model_from_plugin)
      500    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
      100    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
      400    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      100    0.000    0.000    0.000    0.000 profilers.py:59(profile)
      100    0.000    0.000    0.000    0.000 profilers.py:251(stop)
      500    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      300    0.000    0.000    0.000    0.000 base.py:170(on_after_backward)
      300    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      100    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: optimizer_step
         81448 function calls in 3.261 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.002    0.000    3.199    0.032 grad_scaler.py:288(step)
      100    0.004    0.000    3.197    0.032 grad_scaler.py:282(_maybe_opt_step)
      100    0.001    0.000    2.606    0.026 {built-in method builtins.sum}
      200    0.001    0.000    2.605    0.013 grad_scaler.py:284(<genexpr>)
      100    2.604    0.026    2.604    0.026 {method 'item' of 'torch._C._TensorBase' objects}
       94    0.001    0.000    0.587    0.006 lr_scheduler.py:60(wrapper)
       94    0.003    0.000    0.586    0.006 optimizer.py:83(wrapper)
       94    0.068    0.001    0.574    0.006 optimization.py:309(step)
     6392    0.157    0.000    0.157    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
     7426    0.147    0.000    0.147    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
     3196    0.078    0.000    0.078    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      100    0.002    0.000    0.061    0.001 grad_scaler.py:344(update)
      100    0.058    0.001    0.058    0.001 {built-in method _amp_update_scale_}
     3196    0.050    0.000    0.050    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
     3196    0.033    0.000    0.033    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
    19176    0.022    0.000    0.024    0.000 _tensor.py:1001(grad)
       68    0.012    0.000    0.012    0.000 {built-in method zeros_like}
     3230    0.002    0.000    0.004    0.000 _tensor.py:650(__hash__)
       94    0.001    0.000    0.004    0.000 profiler.py:434(__enter__)
    22406    0.004    0.000    0.004    0.000 {built-in method torch._C._has_torch_function_unary}
       94    0.001    0.000    0.003    0.000 profiler.py:426(__init__)
       94    0.003    0.000    0.003    0.000 {built-in method torch._ops.profiler._record_function_enter}
       94    0.002    0.000    0.002    0.000 {built-in method zeros}
       94    0.001    0.000    0.002    0.000 profiler.py:438(__exit__)
      100    0.001    0.000    0.001    0.000 grad_scaler.py:382(<listcomp>)
     3196    0.001    0.000    0.001    0.000 {built-in method math.sqrt}
       94    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_exit}
      100    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
     3330    0.001    0.000    0.001    0.000 {built-in method builtins.id}
      100    0.000    0.000    0.001    0.000 {built-in method builtins.next}
     3496    0.001    0.000    0.001    0.000 {built-in method builtins.len}
      100    0.001    0.000    0.001    0.000 {method 'to' of 'torch._C._TensorBase' objects}
      100    0.000    0.000    0.001    0.000 profilers.py:59(profile)
      100    0.000    0.000    0.000    0.000 profilers.py:251(stop)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      200    0.000    0.000    0.000    0.000 grad_scaler.py:135(_check_scale_growth_tracker)
       94    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      300    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
      100    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: on_before_zero_grad
         4800 function calls in 0.006 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.001    0.000    0.004    0.000 callback_hook.py:220(on_before_zero_grad)
      400    0.000    0.000    0.003    0.000 properties.py:259(get_model)
      400    0.000    0.000    0.003    0.000 model_connector.py:48(get_model)
      400    0.000    0.000    0.003    0.000 model_connector.py:51(_get_reference_model)
      400    0.000    0.000    0.002    0.000 ddp_accelerator.py:359(get_reference_model)
      400    0.001    0.000    0.002    0.000 ddp_plugin.py:123(get_model_from_plugin)
      100    0.000    0.000    0.001    0.000 model_utils.py:21(is_overridden)
      400    0.001    0.000    0.001    0.000 module.py:1164(__getattr__)
      500    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
      100    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      500    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      100    0.000    0.000    0.000    0.000 profilers.py:59(profile)
      100    0.000    0.000    0.000    0.000 profilers.py:251(stop)
      300    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      300    0.000    0.000    0.000    0.000 base.py:176(on_before_zero_grad)
      100    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_batch_end
         4600 function calls in 0.005 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.001    0.000    0.003    0.000 callback_hook.py:134(on_batch_end)
      400    0.000    0.000    0.002    0.000 properties.py:259(get_model)
      400    0.000    0.000    0.002    0.000 model_connector.py:48(get_model)
      400    0.000    0.000    0.002    0.000 model_connector.py:51(_get_reference_model)
      400    0.000    0.000    0.001    0.000 ddp_accelerator.py:359(get_reference_model)
      100    0.000    0.000    0.001    0.000 model_utils.py:21(is_overridden)
      300    0.000    0.000    0.001    0.000 {built-in method builtins.hasattr}
      400    0.001    0.000    0.001    0.000 ddp_plugin.py:123(get_model_from_plugin)
      500    0.001    0.000    0.001    0.000 module.py:1164(__getattr__)
      100    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      100    0.000    0.000    0.000    0.000 profilers.py:59(profile)
      100    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      100    0.000    0.000    0.000    0.000 profilers.py:251(stop)
      500    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      300    0.000    0.000    0.000    0.000 base.py:122(on_batch_end)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      100    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_batch_end
         174664 function calls in 0.273 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.008    0.000    0.258    0.003 callback_hook.py:144(on_train_batch_end)
      100    0.002    0.000    0.248    0.002 progress.py:334(on_train_batch_end)
      200    0.002    0.000    0.215    0.001 std.py:1304(refresh)
      200    0.001    0.000    0.210    0.001 std.py:1436(display)
      100    0.002    0.000    0.159    0.002 progress.py:379(_update_bar)
      100    0.007    0.000    0.157    0.002 std.py:1182(update)
      200    0.001    0.000    0.108    0.001 std.py:346(print_status)
      200    0.002    0.000    0.101    0.001 std.py:1136(__repr__)
      200    0.001    0.000    0.092    0.000 std.py:340(fp_write)
      400    0.000    0.000    0.091    0.000 utils.py:141(inner)
      200    0.091    0.000    0.091    0.000 {method 'write' of '_io.TextIOWrapper' objects}
      200    0.047    0.000    0.087    0.000 std.py:353(format_meter)
      100    0.002    0.000    0.070    0.001 std.py:1376(set_postfix)
      600    0.001    0.000    0.041    0.000 utils.py:324(disp_len)
      600    0.001    0.000    0.039    0.000 utils.py:320(_text_width)
      700    0.009    0.000    0.038    0.000 {built-in method builtins.sum}
    71532    0.020    0.000    0.029    0.000 utils.py:321(<genexpr>)
      200    0.000    0.000    0.015    0.000 utils.py:332(disp_trim)
      100    0.002    0.000    0.014    0.000 properties.py:183(progress_bar_dict)
      200    0.003    0.000    0.013    0.000 std.py:1420(format_dict)
    70932    0.010    0.000    0.010    0.000 {built-in method unicodedata.east_asian_width}
      500    0.000    0.000    0.009    0.000 model_connector.py:48(get_model)
      400    0.000    0.000    0.009    0.000 properties.py:259(get_model)
      200    0.004    0.000    0.009    0.000 utils.py:273(_screen_shape_linux)
      500    0.007    0.000    0.009    0.000 model_connector.py:51(_get_reference_model)
      100    0.002    0.000    0.008    0.000 lightning.py:1382(get_progress_bar_dict)
      200    0.001    0.000    0.007    0.000 model_utils.py:21(is_overridden)
     1700    0.005    0.000    0.007    0.000 {method 'format' of 'str' objects}
     1200    0.006    0.000    0.006    0.000 {built-in method builtins.hasattr}
      200    0.004    0.000    0.005    0.000 {built-in method fcntl.ioctl}
      100    0.000    0.000    0.005    0.000 supporters.py:82(mean)
      100    0.001    0.000    0.005    0.000 supporters.py:94(_agg_memory)
      100    0.004    0.000    0.004    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
      100    0.000    0.000    0.003    0.000 properties.py:175(data_parallel)
      100    0.001    0.000    0.003    0.000 progress.py:106(total_val_batches)
      400    0.002    0.000    0.002    0.000 utils.py:214(_is_ascii)
      400    0.001    0.000    0.002    0.000 std.py:289(format_interval)
      500    0.000    0.000    0.002    0.000 ddp_accelerator.py:359(get_reference_model)
      100    0.001    0.000    0.002    0.000 deprecated_api.py:71(use_dp)
      200    0.001    0.000    0.002    0.000 __init__.py:62(__eq__)
      200    0.001    0.000    0.002    0.000 std.py:188(__format__)
      500    0.001    0.000    0.002    0.000 ddp_plugin.py:123(get_model_from_plugin)
      100    0.000    0.000    0.002    0.000 properties.py:190(disable_validation)
      200    0.001    0.000    0.001    0.000 std.py:108(release)
     1700    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
      200    0.001    0.000    0.001    0.000 std.py:104(acquire)
      100    0.000    0.000    0.001    0.000 properties.py:195(enable_validation)
      200    0.001    0.000    0.001    0.000 {built-in method now}
      200    0.001    0.000    0.001    0.000 std.py:155(__init__)
      600    0.001    0.000    0.001    0.000 module.py:1164(__getattr__)
      100    0.000    0.000    0.001    0.000 std.py:311(format_num)
      600    0.001    0.000    0.001    0.000 {method 'sub' of 're.Pattern' objects}
      100    0.000    0.000    0.001    0.000 progress.py:376(_should_update)
      100    0.001    0.000    0.001    0.000 {method 'item' of 'torch._C._TensorBase' objects}
      400    0.000    0.000    0.001    0.000 types.py:171(__get__)
     4200    0.001    0.000    0.001    0.000 {built-in method builtins.ord}
      100    0.000    0.000    0.001    0.000 contextlib.py:117(__exit__)
      800    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
      100    0.000    0.000    0.001    0.000 {method 'join' of 'str' objects}
      200    0.000    0.000    0.001    0.000 abc.py:96(__instancecheck__)
      200    0.000    0.000    0.001    0.000 utils.py:88(__getattr__)
      100    0.000    0.000    0.001    0.000 deprecated_api.py:82(use_ddp)
      200    0.001    0.000    0.001    0.000 std.py:234(__call__)
      200    0.000    0.000    0.000    0.000 std.py:165(colour)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      200    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
      200    0.000    0.000    0.000    0.000 tensorboard.py:232(version)
      100    0.000    0.000    0.000    0.000 profilers.py:59(profile)
      500    0.000    0.000    0.000    0.000 {built-in method builtins.max}
      100    0.000    0.000    0.000    0.000 progress.py:97(total_train_batches)
      100    0.000    0.000    0.000    0.000 progress.py:242(is_enabled)
      300    0.000    0.000    0.000    0.000 std.py:1402(<genexpr>)
     1000    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
      100    0.000    0.000    0.000    0.000 {built-in method builtins.sorted}
      100    0.000    0.000    0.000    0.000 progress.py:154(on_train_batch_end)
      100    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
      200    0.000    0.000    0.000    0.000 utils.py:57(__init__)
      200    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
      200    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
      100    0.000    0.000    0.000    0.000 profilers.py:251(stop)
      200    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
      400    0.000    0.000    0.000    0.000 enum.py:753(value)
      200    0.000    0.000    0.000    0.000 std.py:169(colour)
      200    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
      500    0.000    0.000    0.000    0.000 progress.py:69(trainer)
      200    0.000    0.000    0.000    0.000 utils.py:61(__format__)
      400    0.000    0.000    0.000    0.000 {built-in method time.time}
      200    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
      600    0.000    0.000    0.000    0.000 {built-in method builtins.len}
      100    0.000    0.000    0.000    0.000 {built-in method builtins.min}
      400    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
      200    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
      300    0.000    0.000    0.000    0.000 progress.py:234(refresh_rate)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
      200    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
      200    0.000    0.000    0.000    0.000 {method 'keys' of 'collections.OrderedDict' objects}
      200    0.000    0.000    0.000    0.000 base.py:66(on_train_batch_end)
      200    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
      100    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 progress.py:73(train_batch_idx)
      100    0.000    0.000    0.000    0.000 typing.py:1149(cast)
      100    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_epoch_end
         48 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:104(on_epoch_end)
        4    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        4    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        4    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        1    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        4    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        4    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profilers.py:59(profile)
        1    0.000    0.000    0.000    0.000 profilers.py:251(stop)
        4    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.000    0.000 base.py:98(on_epoch_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_epoch_end
         50 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:74(on_train_epoch_end)
        4    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        4    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        4    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        4    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        4    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        1    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profilers.py:59(profile)
        4    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        1    0.000    0.000    0.000    0.000 profilers.py:251(stop)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.000    0.000 base.py:74(on_train_epoch_end)
        1    0.000    0.000    0.000    0.000 accelerator.py:132(on_train_epoch_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_end
         893 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 callback_hook.py:114(on_train_end)
        1    0.000    0.000    0.001    0.001 progress.py:358(on_train_end)
        1    0.000    0.000    0.001    0.001 std.py:1248(close)
        1    0.000    0.000    0.000    0.000 std.py:1436(display)
        1    0.000    0.000    0.000    0.000 std.py:1136(__repr__)
        1    0.000    0.000    0.000    0.000 std.py:353(format_meter)
        3    0.000    0.000    0.000    0.000 utils.py:324(disp_len)
        3    0.000    0.000    0.000    0.000 utils.py:320(_text_width)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
        1    0.000    0.000    0.000    0.000 std.py:583(_decr_instances)
      359    0.000    0.000    0.000    0.000 utils.py:321(<genexpr>)
        1    0.000    0.000    0.000    0.000 std.py:1420(format_dict)
        1    0.000    0.000    0.000    0.000 std.py:346(print_status)
        1    0.000    0.000    0.000    0.000 utils.py:273(_screen_shape_linux)
        1    0.000    0.000    0.000    0.000 utils.py:332(disp_trim)
      356    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        8    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        4    0.000    0.000    0.000    0.000 utils.py:141(inner)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:106(remove)
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        2    0.000    0.000    0.000    0.000 std.py:104(acquire)
        1    0.000    0.000    0.000    0.000 std.py:340(fp_write)
        4    0.000    0.000    0.000    0.000 properties.py:259(get_model)
        3    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        4    0.000    0.000    0.000    0.000 model_connector.py:48(get_model)
        2    0.000    0.000    0.000    0.000 std.py:1265(fp_write)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:58(__iter__)
        2    0.000    0.000    0.000    0.000 {method 'remove' of 'set' objects}
        1    0.000    0.000    0.000    0.000 model_utils.py:21(is_overridden)
        4    0.000    0.000    0.000    0.000 model_connector.py:51(_get_reference_model)
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
        2    0.000    0.000    0.000    0.000 std.py:289(format_interval)
        4    0.000    0.000    0.000    0.000 ddp_accelerator.py:359(get_reference_model)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        2    0.000    0.000    0.000    0.000 std.py:108(release)
        7    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        4    0.000    0.000    0.000    0.000 ddp_plugin.py:123(get_model_from_plugin)
        2    0.000    0.000    0.000    0.000 utils.py:214(_is_ascii)
        1    0.000    0.000    0.000    0.000 std.py:155(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 profilers.py:59(profile)
        1    0.000    0.000    0.000    0.000 utils.py:74(__eq__)
        1    0.000    0.000    0.000    0.000 std.py:188(__format__)
        1    0.000    0.000    0.000    0.000 {built-in method now}
        1    0.000    0.000    0.000    0.000 profilers.py:251(stop)
        3    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        8    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 std.py:1139(_comparable)
        4    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:26(__exit__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:20(__enter__)
       21    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
        1    0.000    0.000    0.000    0.000 std.py:169(colour)
        1    0.000    0.000    0.000    0.000 std.py:1143(__hash__)
        1    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        7    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 _weakrefset.py:16(__init__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:52(_commit_removals)
        2    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 ddp_accelerator.py:205(on_train_end)
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        3    0.000    0.000    0.000    0.000 base.py:130(on_train_end)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 std.py:165(colour)
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        1    0.000    0.000    0.000    0.000 std.py:1280(<lambda>)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


